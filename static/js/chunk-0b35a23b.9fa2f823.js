(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0b35a23b"],{"078f":function(t,e,a){"use strict";var i=a("1147"),n=a.n(i);n.a},"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function r(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(t,e,a){var s=r(),l=t-s,o=20,c=0;e="undefined"===typeof e?500:e;var d=function t(){c+=o;var r=Math.easeInOutQuad(c,s,l,e);n(r),c<e?i(t):a&&"function"===typeof a&&a()};d()}},1147:function(t,e,a){},"12f9":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,width:"500px",title:"扫描存档",visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{attrs:{id:"noniediv"}},[a("p",{staticClass:"xform-p"}),t._v(" "),a("p",{staticClass:"xform-p",attrs:{id:"streamwrap"}},[a("img",{staticClass:"xform",attrs:{id:"streamimage",src:"http://127.0.0.1:38088/video=stream&camidx=0",onerror:"onerror=null;src='http://kykjgm.lxygm.com/app_stop.jpg'"}})])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.getimg}},[t._v("保存")])],1)])},n=[],r=(a("6b54"),a("bc3a")),s=a.n(r),l={data:function(){return{dialogFormVisible:!1}},methods:{getimg:function(){var t=this,e=0,a=0,i='{"filepath":"base64","rotate":"'+e.toString()+'","camidx":"'+a.toString()+'","cutpage":"1"}',n="http://127.0.0.1:38088/video=grabimage";s.a.post(n,i).then((function(e){0==e.data.code&&(t.$emit("setImg","data:image/jpg;base64,"+e.data.photoBase64),t.$notify.success({title:"成功",message:"照片保存成功"}),t.dialogFormVisible=!1)}))},show:function(){this.dialogFormVisible=!0}}},o=l,c=(a("83fb"),a("2877")),d=Object(c["a"])(o,i,n,!1,null,null,null);e["a"]=d.exports},1977:function(t,e,a){"use strict";var i=a("bde0"),n=a.n(i);n.a},"1efe":function(t,e,a){},"22ce":function(t,e,a){"use strict";a.d(e,"i",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"j",(function(){return s})),a.d(e,"b",(function(){return l})),a.d(e,"f",(function(){return o})),a.d(e,"d",(function(){return c})),a.d(e,"c",(function(){return d})),a.d(e,"e",(function(){return u})),a.d(e,"h",(function(){return m})),a.d(e,"g",(function(){return p}));var i=a("b775");function n(t){return Object(i["a"])({url:"/service_info/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/service_info/add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/service_info/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/service_info/del",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/lampplan/list",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/lampplan/del",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/lampplan/add",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/lampplan/edit",method:"post",data:t})}function m(t){return Object(i["a"])({url:"/service_info/lightup_info_list",method:"get",params:t})}function p(t){return Object(i["a"])({url:"/service_info/lightup_info_edit",method:"post",data:t})}},"386b":function(t,e,a){var i=a("5ca1"),n=a("79e5"),r=a("be13"),s=/"/g,l=function(t,e,a,i){var n=String(r(t)),l="<"+e;return""!==a&&(l+=" "+a+'="'+String(i).replace(s,"&quot;")+'"'),l+">"+n+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(l),i(i.P+i.F*n((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",a)}},"3a76":function(t,e,a){},"43d0":function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return l})),a.d(e,"e",(function(){return o}));var i=a("b775");function n(t){return Object(i["a"])({url:"/cemetery/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/cemetery/add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/cemetery/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/cemetery/del",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/cemetery/update_cemetery_usestatus_qian",method:"get",params:t})}},"47c5":function(t,e,a){"use strict";a.d(e,"h",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"a",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"c",(function(){return o})),a.d(e,"e",(function(){return c})),a.d(e,"d",(function(){return d})),a.d(e,"g",(function(){return u}));var i=a("b775");function n(t){return Object(i["a"])({url:"/order/get_services_order_list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/order/buy_services_order_info",method:"get",params:t})}function s(t){return Object(i["a"])({url:"/order/buy_services",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/order/buy_services_edit",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/order/buy_cemetery_del",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/order/dy_services_bylb",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/order/dy_services_byfw",method:"get",params:t})}function u(t){return Object(i["a"])({url:"/service_info/get_services_all",method:"get",params:t})}},"54d3":function(t,e,a){},"599c":function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"f",(function(){return s})),a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return c}));var i=a("b775");function n(t){return Object(i["a"])({url:"/cemetery_classify/a_list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/cemetery_classify/a_add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/cemetery_classify/a_edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/cemetery_classify/a_del",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/cemetery_classify/classifyList",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/cemetery/tralist",method:"get",params:t})}},"5c54":function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"b",(function(){return r})),a.d(e,"f",(function(){return s})),a.d(e,"c",(function(){return l})),a.d(e,"a",(function(){return o})),a.d(e,"e",(function(){return c}));var i=a("b775");function n(t){return Object(i["a"])({url:"/reserve/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/order/dispose",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/reserve/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/reserve/del",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/reserve/all_list",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/order/refund",method:"post",data:t})}},"73e0":function(t,e,a){"use strict";var i=a("54d3"),n=a.n(i);n.a},7514:function(t,e,a){"use strict";var i=a("5ca1"),n=a("0a49")(5),r="find",s=!0;r in[]&&Array(1)[r]((function(){s=!1})),i(i.P+i.F*s,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")(r)},8194:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"c",(function(){return s}));var i=a("b775");function n(t){return Object(i["a"])({url:"/manager/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/manager/add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/manager/edit",method:"post",data:t})}},"83fb":function(t,e,a){"use strict";var i=a("1efe"),n=a.n(i);n.a},8996:function(t,e,a){"use strict";var i=a("fe61"),n=a.n(i);n.a},"91b6":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var i="http://kykjgm.lxygm.com/api/v1/upload/upload"},a01c:function(t,e,a){"use strict";a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"b",(function(){return l}));var i=a("b775");function n(t){return Object(i["a"])({url:"/cemetery_type/list",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/cemetery_type/add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/cemetery_type/edit",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/cemetery_type/del",method:"get",params:t})}},a471:function(t,e,a){"use strict";var i=a("3a76"),n=a.n(i);n.a},a6c4:function(t,e,a){"use strict";var i=a("f73f"),n=a.n(i);n.a},b54a:function(t,e,a){"use strict";a("386b")("link",(function(t){return function(e){return t(this,"a","href",e)}}))},bde0:function(t,e,a){},c3be:function(t,e,a){"use strict";a.d(e,"i",(function(){return n})),a.d(e,"g",(function(){return r})),a.d(e,"h",(function(){return s})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return o})),a.d(e,"a",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"e",(function(){return m}));var i=a("b775");function n(t){return Object(i["a"])({url:"/repair/get_repair_info_by_cid",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/repair/repair_add",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/repair/get_repair_info_by_id",method:"get",params:t})}function l(t){return Object(i["a"])({url:"/repair/repair_edit",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/repair/repair_del_pic",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/repair/repair_del",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/repair/repair_order_list",method:"get",params:t})}function u(t){return Object(i["a"])({url:"/repair/repair_edit_after",method:"post",data:t})}function m(t){return Object(i["a"])({url:"/repair/repair_edit_pic",method:"post",data:t})}},c9cc:function(t,e,a){"use strict";var i=a("f2e7"),n=a.n(i);n.a},caa9:function(t,e,a){"use strict";var i=a("e48e"),n=a.n(i);n.a},d8e83:function(t,e,a){"use strict";var i=a("e011"),n=a.n(i);n.a},e011:function(t,e,a){},e48e:function(t,e,a){},f2e7:function(t,e,a){},f73f:function(t,e,a){},fa8c:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",size:"small",placeholder:"请输入逝者姓名或墓号"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleFilters(e)}},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",e)},expression:"listQuery.keyword"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:t.handleFilters}},[t._v("查找")]),t._v(" "),a("el-radio-group",{staticClass:"filter-item",staticStyle:{float:"right"},attrs:{size:"small"},model:{value:t.isCollapse,callback:function(e){t.isCollapse=e},expression:"isCollapse"}},[a("el-radio-button",{attrs:{label:!1}},[t._v("业务")]),t._v(" "),a("el-radio-button",{attrs:{label:!0}},[t._v("墓位")])],1)],1),t._v(" "),a("el-container",[a("el-main",[a("div",{staticClass:"menu"},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":String(t.listQuery.q_id)}},t._l(t.area,(function(e,i){return a("el-submenu",{key:i,attrs:{index:String(i)}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-more-outline"}),t._v(" "),a("span",[t._v(t._s(e.type_name))])]),t._v(" "),t._l(e.son,(function(e,i){return a("el-menu-item-group",{key:i},[a("el-menu-item",{attrs:{index:String(e.id)},on:{click:function(a){return t.handleFilter(e.id)}}},[t._v(t._s(e.type_name))])],1)}))],2)})),1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticStyle:{display:"block"},style:t.isCollapse?"padding-left: 38px;":""},t._l(t.num,(function(e,i,n){return a("el-tag",{directives:[{name:"show",rawName:"v-show",value:7!=i,expression:"item != 7"}],key:n,class:t._f("getNum")(i),staticStyle:{"margin-left":"5px"},attrs:{size:"small"},on:{click:function(e){return t.handleFilterTag(i)}}},[t._v(t._s(t._f("getNumtxt")(i))+"("+t._s(e)+")")])})),1),t._v(" "),t.isCollapse?t._l(t.tralist,(function(e,i){return a("div",{key:i,staticClass:"tralist"},[a("span",[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"tralist-li"},t._l(e.cemetery,(function(e,i){return a("div",{key:i,class:t._f("getlist")(e.usestatus),style:0==e.id?"visibility:hidden":""},[t._v(t._s(e.iy))])})),0)])})):[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{display:"inline-block"}},[a("el-row",{staticStyle:{"flex-wrap":"wrap"},attrs:{type:"flex"}},t._l(t.list,(function(e,i){return a("el-col",{key:i,class:t._f("getlist")(e.usestatus),staticStyle:{width:"137px"}},[a("div",{staticStyle:{height:"100%"},on:{click:function(a){return t.createCemetery(e)}}},[a("div",{staticStyle:{height:"100px"}},[a("p",{staticStyle:{"font-size":"14px"}},[t._v(t._s(e.classifyname)+t._s(e.cname))]),t._v(" "),null!=e.muzhu_name?[a("p",[t._v(t._s(e.muzhu_name.split(",")[0]))]),t._v(" "),a("p",[t._v(t._s(e.muzhu_name.split(",")[1]))])]:t._e()],2),t._v(" "),a("p",[a("svg-icon",{attrs:{"icon-class":"one","class-name":"customs-class"}}),t._v(" "),2==e.type_id?a("svg-icon",{attrs:{"class-name":"customs-class","icon-class":"one"}}):t._e()],1)])])})),1)],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}})]],2)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{id:"cemetery","close-on-click-modal":!1,title:t.dialogStatus,visible:t.dialogFormVisible,top:"5vh"},on:{"update:visible":function(e){t.dialogFormVisible=e},open:function(e){t.activeName="sell"}}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},t._l(t.tab,(function(e,i){return a("el-tab-pane",{key:i,attrs:{label:e.label,name:e.name}},[a(e.name,{tag:"component",on:{v:t.v}})],1)})),1)],1)],1)},n=[],r=(a("7f7f"),a("ac6a"),a("599c")),s=a("43d0"),l=a("ef42"),o=a("ac0d"),c=a("333d"),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加服务信息")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",width:"110",label:"合同号",prop:"order_no"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"80",label:"购墓人",prop:"buyer_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"100",label:"购买日期",prop:"create_time"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("parseTime")(e.row.create_time,"{y}-{m}-{d}")))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"服务项目",prop:"service_title","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"80",label:"服务总价",prop:"sum_price"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.order_status?[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]:a("el-button",{attrs:{type:"info",size:"mini",plain:"",disabled:""}},[t._v("已付款")])]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{id:"service","close-on-click-modal":!1,title:"选服务",visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("service",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"server",on:{service_data:t.service_data}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createDateServer}},[t._v("确定")])],1)],1)],1)},u=[],m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form",{ref:"dataForm",attrs:{inline:!0,model:t.dataForm,"status-icon":"","label-position":"left","label-width":"80px"}},[a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"付款人",prop:"buyer_name"}},[a("el-select",{staticStyle:{width:"140px!important"},attrs:{filterable:"",size:"mini","allow-create":"","default-first-option":"",placeholder:"请选择"},on:{change:t.linkPhone},model:{value:t.dataForm.buyer_name,callback:function(e){t.$set(t.dataForm,"buyer_name",e)},expression:"dataForm.buyer_name"}},t._l(t.link,(function(t){return a("el-option",{key:t.id,attrs:{label:t.link_name,value:t.link_name}})})),1)],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{label:"联系电话",prop:"phone"}},[a("el-input",{staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"请输入电话"},model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"服务时间"}},[a("el-date-picker",{staticStyle:{width:"140px!important"},attrs:{size:"mini",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.service_time,callback:function(e){t.$set(t.dataForm,"service_time",e)},expression:"dataForm.service_time"}})],1)],1),t._v(" "),a("el-tabs",{attrs:{"tab-position":"top"},on:{"tab-click":t.handleClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[t._l(t.tab,(function(e,i){return a("el-tab-pane",{key:i,attrs:{label:e.label,name:e.label}},[a("el-table",{ref:"sellTable",refInFor:!0,staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{border:"","highlight-current-row":"",data:e.list,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"service_name",align:"center",label:"服务名称",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"chargeunit",align:"center",label:"单位",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sell_price",align:"center",label:"服务价格","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[[a("el-input",{staticClass:"edit-input",staticStyle:{width:"80px"},attrs:{size:"mini"},on:{blur:function(e){return t.confirmEdit(i)}},model:{value:i.sell_price,callback:function(e){t.$set(i,"sell_price",e)},expression:"row.sell_price"}}),t._v(" "),a("el-input-number",{attrs:{min:1,max:100,label:"",size:"mini"},on:{change:function(e){return t.handleChange(i)}},model:{value:i.amount,callback:function(e){t.$set(i,"amount",e)},expression:"row.amount"}})]]}}],null,!0)}),t._v(" "),a("el-table-column",{attrs:{prop:"vcnote",align:"center",label:"备注",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("el-input",{staticClass:"edit-input",staticStyle:{width:"130px"},attrs:{size:"mini"},model:{value:i.vcnote,callback:function(e){t.$set(i,"vcnote",e)},expression:"row.vcnote"}})]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"el-divider el-divider--horizontal"},[a("div",{staticClass:"el-divider__text is-left"},[t._v("已选项目")])])],1)})),t._v(" "),a("el-table",{attrs:{"show-header":!1,"show-summary":"",data:t.sell}},[a("el-table-column",{attrs:{type:"index",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"service_name",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sell_price",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"amount",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{prop:"totalprice"}})],1)],2)],1)},p=[],h=(a("7514"),a("b54a"),a("96cf"),a("3b8d")),f=a("b775");function _(t){return Object(f["a"])({url:"/linkman/list",method:"get",params:t})}function v(t){return Object(f["a"])({url:"/linkman/add",method:"post",data:t})}function g(t){return Object(f["a"])({url:"/linkman/edit",method:"post",data:t})}function b(t){return Object(f["a"])({url:"/linkman/del",method:"get",params:t})}var y={mixins:[o["b"],o["a"]],data:function(){return{dataForm:{buyer_name:"",id:"",phone:"",service_time:""},link:[],service:[],sell:[],list:null,clear:0,row:null,num:1,tab:[],index:0,sum_price:0,active:""}},watch:{sell:{handler:function(){this.changeSell()},immediate:!0}},created:function(){var t=this,e={cid:this.cems.id};_(e).then((function(e){t.link=e.data})).catch((function(){t.link=[]}))},methods:{getList:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.init(),this.$nextTick(Object(h["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.tab.length)){t.next=15;break}if(0!=e.clear){t.next=8;break}e.$refs.sellTable[a].clearSelection(),e.rest(),e.init(),t.next=12;break;case 8:return t.next=10,e.edit(a);case 10:return t.next=12,e.edit(0);case 12:a++,t.next=1;break;case 15:case"end":return t.stop()}}),t)}))));case 2:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleChange:function(t){t.totalprice=t.amount*t.sell_price,this.changeSell()},handleClick:function(t,e){this.index=t.index},linkPhone:function(t){var e=this;this.link.forEach((function(a){a.id==t&&(e.dataForm.phone=a.phone)}))},init:function(){var t=this,e=[];this.active=this.list[0].title||"",this.list.map((function(a){a.services.map((function(e){t.$set(e,"amount",1),t.$set(e,"totalprice",e.sell_price)})),e.push({label:a.title,list:a.services,sells:[]})})),this.tab=e},edit:function(t){var e=this;this.index=t,this.$nextTick((function(){e.$refs.sellTable[t].clearSelection(),e.service.forEach((function(a,i){var n=[];n=a.services,n.forEach((function(a){e.$refs.sellTable[t].data.forEach((function(t){for(var e in t)t.id==a.sid&&(t.sell_price=a.sell_price,t.totalprice=a.totalprice,t.amount=a.amount)})),e.$refs.sellTable[t].toggleRowSelection(e.$refs.sellTable[t].data.find((function(t){return t.id===a.sid})),!0)}))}))}))},showService:function(t){this.clear=t.type,this.list=t.server,this.getList()},editService:function(t){this.rest(),this.dataForm={buyer_name:t.buyer_name,phone:t.phone,id:t.id,service_time:t.service_time},this.service=t.services,this.getList()},rest:function(){this.dataForm={buyer_name:"",phone:"",id:"",service_time:""}},confirmEdit:function(t){this.changeSell(),this.handleChange(t),this.$refs.sellTable[this.index].toggleRowSelection(t,!0)},changeSell:function(){var t=0;this.sell&&this.sell.forEach((function(e,a){t+=parseInt(e.totalprice)})),this.sum_price=t;var e={id:this.dataForm.id,sum_price:this.sum_price,buyer_name:this.dataForm.buyer_name,phone:this.dataForm.phone,service_time:this.dataForm.service_time,server:this.sell};this.$emit("service_data",e)},handleSelectionChange:function(t){var e=this;this.tab[this.index].sells=t.filter((function(t){return void 0!=t}));var a=[];this.tab.forEach((function(t,i){a.push(e.tab[i].sells)})),a=[].concat.apply([],a),this.sell=a}}},F=y,x=a("2877"),k=Object(x["a"])(F,m,p,!1,null,null,null),w=k.exports,$=a("47c5"),C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{height:"700px",position:"relative"}},[a("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:function(e){t.flag=!0}}},[t._v("竖碑")]),t._v(" "),a("el-button",{attrs:{type:"danger",plain:"",size:"small"},on:{click:function(e){t.flag=!1}}},[t._v("横碑")]),t._v(" "),t.flag?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addBig}},[t._v("添加竖碑(大)")]):t._e(),t._v(" "),t.flag?a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addSmall}},[t._v("添加竖碑(小)")]):t._e(),t._v(" "),t.flag?t._e():a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.addh}},[t._v("添加横碑")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.rest}},[t._v("重置碑文")]),t._v(" "),a("el-button",{attrs:{type:"primary",plain:"",size:"small"},on:{click:t.print}},[t._v("打印")]),t._v(" "),a("section",{ref:"print"},[t.flag?[t._l(t.vert,(function(t,e){return[a("drag",{key:e,attrs:{child:t}})]}))]:[t._l(t.hori,(function(t,e){return[a("drag",{key:e,attrs:{child:t}})]}))]],2)],1)},S=[],j=(a("4917"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"box",style:{top:t.child.p+"px",left:t.child.l+"px",width:t.child.h?"auto":"22px",border:t.child.e?"1px dashed #ccc":"","font-size":t.child.s?"20px":"16px"},attrs:{contenteditable:!0},domProps:{innerHTML:t._s(t.innerText)},on:{input:t.changeTxt,focus:function(e){t.lock=!0},blur:function(e){t.lock=!1}}})}),O=[],L={directives:{drag:{bind:function(t){var e=t;e.onmousedown=function(t){var a=t.clientX-e.offsetLeft,i=t.clientY-e.offsetTop;document.onmousemove=function(t){var n=t.clientX-a,r=t.clientY-i;window.positionX=r,window.positionY=n,e.style.left=n+"px",e.style.top=r+"px"},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}}},props:{child:{type:Object,required:!0}},data:function(){return{innerText:this.child.t,lock:!1}},watch:{child:{handler:function(t,e){this.lock||(this.innerText=this.child.t)},deep:!0}},methods:{changeTxt:function(t){this.child.t=this.$el.innerHTML}}},V=L,z=(a("d8e83"),Object(x["a"])(V,j,O,!1,null,"3015d82a",null)),D=z.exports,T={initHori:[{t:"父",s:!0,e:!0,h:!0,l:150,p:100},{t:"母",s:!0,e:!0,h:!0,l:150,p:150},{t:"孝男",s:!1,e:!0,h:!0,l:130,p:220},{t:"媳",s:!1,e:!0,h:!0,l:300,p:220},{t:"孙",s:!1,e:!0,h:!0,l:500,p:220},{t:"女",s:!1,e:!0,h:!0,l:150,p:300},{t:"婿",s:!1,e:!0,h:!0,l:300,p:300},{t:"年",s:!0,e:!0,h:!0,l:580,p:430},{t:"月",s:!0,e:!0,h:!0,l:660,p:430},{t:"日立",s:!0,e:!0,h:!0,l:730,p:430}],initVert:[{t:"先",s:!1,e:!0,h:!1,l:755,p:45},{t:"生于",s:!1,e:!0,h:!1,l:755,p:80},{t:"母",s:!1,e:!0,h:!1,l:720,p:60},{t:"父",s:!1,e:!0,h:!1,l:795,p:60},{t:"年",s:!1,e:!0,h:!1,l:755,p:180},{t:"月",s:!1,e:!0,h:!1,l:755,p:245},{t:"日卒于",s:!1,e:!0,h:!1,l:755,p:320},{t:"年",s:!1,e:!0,h:!1,l:755,p:435},{t:"月",s:!1,e:!0,h:!1,l:755,p:500},{t:"日",s:!1,e:!0,h:!1,l:755,p:560},{t:"先",s:!0,e:!0,h:!1,l:500,p:45},{t:"母",s:!0,e:!0,h:!1,l:460,p:70},{t:"父",s:!0,e:!0,h:!1,l:540,p:70},{t:"",s:!0,e:!0,h:!1,l:540,p:105,match:"dead1"},{t:"",s:!0,e:!0,h:!1,l:460,p:105,match:"dead2"},{t:"大人之墓",s:!0,e:!0,h:!1,l:500,p:270},{t:"孝",s:!1,e:!0,h:!1,l:255,p:45},{t:"女",s:!1,e:!0,h:!1,l:210,p:70},{t:"男",s:!1,e:!0,h:!1,l:300,p:70},{t:"年",s:!1,e:!0,h:!1,l:125,p:365},{t:"月",s:!1,e:!0,h:!1,l:125,p:430},{t:"日立",s:!1,e:!0,h:!1,l:125,p:500},{t:"",s:!1,e:!0,h:!1,l:210,p:105},{t:"",s:!1,e:!0,h:!1,l:240,p:105},{t:"",s:!1,e:!0,h:!1,l:270,p:105},{t:"",s:!1,e:!0,h:!1,l:300,p:105}]};function E(t){return Object(f["a"])({url:"/bury/list",method:"get",params:t})}function M(t){return Object(f["a"])({url:"/bury/add",method:"post",data:t})}function I(t){return Object(f["a"])({url:"/bury/edit",method:"post",data:t})}function Q(t){return Object(f["a"])({url:"/bury/del",method:"post",data:t})}function P(t){return Object(f["a"])({url:"/bury/an_zhang",method:"post",data:t})}function B(t){return Object(f["a"])({url:"/images/list",method:"get",params:t})}function N(t){return Object(f["a"])({url:"/images/del",method:"get",params:t})}function q(t){return Object(f["a"])({url:"/images/dispose",method:"post",data:t})}function R(t){return Object(f["a"])({url:"/cemetery/get_inscription",method:"get",params:t})}function U(t){return Object(f["a"])({url:"/cemetery/inscription_add",method:"post",data:t})}var Y=T.initHori,A=T.initVert,H={components:{Drag:D},mixins:[o["b"]],data:function(){return{sex:"男",flag:!0,dead:null,hori:[],vert:[]}},watch:{cems:{handler:function(t){this.init(),this.setBorder()},immediate:!0}},created:function(){},methods:{init:function(){var t=this,e={cid:this.cems.id};R(e).then((function(e){e.data?t.vert=e.data:t.rest()})),E(e).then((function(e){var a={dead1:"",dead2:""};e.data.forEach((function(i,n){i.sex===t.sex?a.dead1=e.data[n].vcname:a.dead2=e.data[n].vcname})),A.forEach((function(t,e){"dead1"===t.match?t.t=a.dead1:"dead2"===t.match&&(t.t=a.dead2)}))})),this.hori=Object.assign([],Y),this.vert=Object.assign([],A)},addBig:function(){var t={t:"大",s:!0,e:!0,h:!1,l:550,p:20};this.vert.push(t)},addSmall:function(){var t={t:"小",s:!1,e:!0,h:!1,l:600,p:20};this.vert.push(t)},addh:function(){var t={t:"横碑",s:!1,e:!0,h:!0,l:700,p:20};this.hori.push(t)},print:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.clearBorder();case 2:return t.next=4,this.$print(this.$refs.print);case 4:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setBorder:function(){this.vert.forEach((function(t,e){t.e||(t.e=!0)})),this.hori.forEach((function(t,e){t.e||(t.e=!0)}))},clearBorder:function(){this.vert.forEach((function(t,e){t.e&&(t.e=!1)})),this.hori.forEach((function(t,e){t.e&&(t.e=!1)}))},rest:function(){this.flag?this.vert=Object.assign([],A):this.hori=Object.assign([],Y)},getData:function(){var t=this,e={cid:this.cems.id,inscription:this.vert};U(e).then((function(e){t.$emit("CloseDialog"),t.$message({type:"success",message:"操作成功"})})).catch((function(e){t.$message({type:"warning",message:e.msg})}))}}},G=H,J=Object(x["a"])(G,C,S,!1,null,null,null),X=J.exports,K={components:{Service:w,Monumen:X},mixins:[o["b"],o["a"]],data:function(){return{index:2,id:"",list:null,status:!1,linkman_id:"",listlink:"",linkdata:null,dialogFormVisible:!1,listLoading:!1,loading:!1,dialogStatus:"",dataForm:{cid:"",id:"",buyer_name:null,phone:"",services:[],service_time:"",seller_id:"",sellname:"",financetype:3,real_price:""}}},watch:{cems:{handler:function(t){this.getList()},immediate:!0}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};Object($["h"])(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},getCommon:function(t){var e=this,a={type:2};this.loading=!0,Object($["g"])(a).then((function(a){e.server=a.data;var i={type:t,server:e.server};e.loading=!1,e.$refs.server.showService(i)}))},handleCreate:function(){this.dialogFormVisible=!0,this.dialogStatus="create",this.getCommon(0)},service_data:function(t){this.dataForm.id=t.id,this.dataForm.cid=this.cems.id,this.dataForm.seller_id=this.user.id,this.dataForm.sellname=this.user.realname,this.dataForm.real_price=t.sum_price,this.dataForm.phone=t.phone,this.dataForm.service_time=t.service_time,this.dataForm.services=t.server,this.dataForm.buyer_name=t.buyer_name},createDateServer:function(){var t=this;Object($["a"])(this.dataForm).then((function(e){t.$message({type:"success",message:"添加服务成功"}),t.getList(),t.dialogFormVisible=!1})).catch((function(e){t.$message({type:"warning",message:e})}))},handleUpdate:function(t){var e=this;this.dialogFormVisible=!0,this.dialogStatus="edit",this.getCommon(1),this.id=t.id;var a={id:t.id,cid:t.cid};Object($["b"])(a).then((function(t){e.$refs.server.editService(t.data)}))},updateDataServer:function(){var t=this;this.dataForm.cid=this.cems.id,this.dataForm.id=this.id,Object($["f"])(this.dataForm).then((function(e){t.$message({message:"编辑服务成功",type:"success"}),t.dialogFormVisible=!1,t.CloseDialog()})).catch((function(e){t.$message({type:"warning",message:e})}))},CloseDialog:function(t){this.getList(),this.dialogFormVisible=!1},handleDelete:function(t){var e=this;this.$confirm("您确认此操作?","删除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id,cid:t.cid,financetype:3};Object($["c"])(a).then((function(t){e.$message({type:"success",message:"删除服务成功"}),e.getList()})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},createDate:function(){this.$refs.get.getData()}}},W=K,Z=(a("1977"),Object(x["a"])(W,d,u,!1,null,null,null)),tt=Z.exports,et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("buy",{ref:"buy",on:{v:t.v}}),t._v(" "),a("dead",{ref:"dead",on:{v:t.v}}),t._v(" "),a("linkman",{ref:"linkman",on:{v:t.v}})],1)},at=[],it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("el-button",{staticClass:"filter-item",staticStyle:{margin:"0 0 10px 0"},attrs:{type:"primary",icon:"el-icon-edit",disabled:t.cname.usestatus>2||t.list&&t.list.length>0},on:{click:t.handleBury}},[t._v("添加购墓信息")]),t._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{margin:"0 0 10px 0"},attrs:{type:"primary",plain:"",icon:"el-icon-printer"},on:{click:function(e){return t.CemeteryPrint()}}},[t._v("购墓申请单")]),t._v(" "),a("el-button",{staticClass:"filter-item",staticStyle:{margin:"0 0 10px 0"},attrs:{type:"primary",plain:"",icon:"el-icon-printer"},on:{click:function(e){return t.handlePay()}}},[t._v("购墓合同")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"订单号",prop:"order_no",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"档案编号",prop:"dabh",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发票号",prop:"fph",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"80",label:"购墓人",prop:"buyer_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"购买日期",prop:"order_begin"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"到期日期",prop:"order_end"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"80",label:"销售金额",prop:"sell_price"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",width:"80",label:"实收金额",prop:"real_price"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),t.cname.usestatus<3?a("el-button",{staticStyle:{"margin-top":"5px"},attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"1vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",attrs:{inline:!0,rules:t.rules,model:t.dataForm,"status-icon":"","label-position":"left","label-width":"100px"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.getCard}},[t._v("联系人信息")])],1),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}}),t._v(" "),a("el-form-item",{attrs:{label:"档案编号",prop:"dabh"}},[a("el-input",{model:{value:t.dataForm.dabh,callback:function(e){t.$set(t.dataForm,"dabh",e)},expression:"dataForm.dabh"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"发票号",prop:"fph"}},[a("el-input",{model:{value:t.dataForm.fph,callback:function(e){t.$set(t.dataForm,"fph",e)},expression:"dataForm.fph"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"buyer_name"}},[a("el-input",{model:{value:t.dataForm.buyer_name,callback:function(e){t.$set(t.dataForm,"buyer_name",e)},expression:"dataForm.buyer_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话"}},[a("el-input",{model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证"}},[a("el-input",{staticClass:"card",model:{value:t.dataForm.card_no,callback:function(e){t.$set(t.dataForm,"card_no",e)},expression:"dataForm.card_no"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"关系"}},[a("el-input",{model:{value:t.dataForm.relation,callback:function(e){t.$set(t.dataForm,"relation",e)},expression:"dataForm.relation"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"住址"}},[a("el-input",{model:{value:t.dataForm.address,callback:function(e){t.$set(t.dataForm,"address",e)},expression:"dataForm.address"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"销售金额"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.dataForm.sell_price,callback:function(e){t.$set(t.dataForm,"sell_price",e)},expression:"dataForm.sell_price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"购买日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},on:{change:t.changedate},model:{value:t.dataForm.order_begin,callback:function(e){t.$set(t.dataForm,"order_begin",e)},expression:"dataForm.order_begin"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"到期日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.order_end,callback:function(e){t.$set(t.dataForm,"order_end",e)},expression:"dataForm.order_end"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"实收金额",prop:"real_price"}},[a("el-input",{model:{value:t.dataForm.real_price,callback:function(e){t.$set(t.dataForm,"real_price",e)},expression:"dataForm.real_price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"vcdesc"}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.dataForm.vcdesc,callback:function(e){t.$set(t.dataForm,"vcdesc",e)},expression:"dataForm.vcdesc"}})],1),t._v(" "),t.dataFormEdit?[a("el-form-item",{attrs:{label:"身份证(正)"}},[a("div",{staticClass:"uploader_photo dead_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.dataForm.card_photo_z?[a("img",{staticClass:"avatar",attrs:{src:t.dataForm.card_photo_z}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.dataForm.card_photo_z=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(1)}}})],2)])]),t._v(" "),a("el-form-item",{attrs:{label:"身份证(反)"}},[a("div",{staticClass:"uploader_photo dead_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.dataForm.card_photo_f?[a("img",{staticClass:"avatar",attrs:{src:t.dataForm.card_photo_f}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.dataForm.card_photo_f=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(2)}}})],2)])])]:t._e()],2),t._v(" "),t.dataFormEdit?[a("div",{staticClass:"ele"}),t._v(" "),a("Vue-form",{ref:"child",on:{CloseDialog:t.CloseDialog}})]:t._e(),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],2),t._v(" "),a("contract",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"contract_"}),t._v(" "),a("reserver",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"reserver_"})],1)},nt=[],rt=a("e97f"),st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{height:"90px"}},[a("el-form",{ref:"bury",staticStyle:{width:"600px"},attrs:{"status-icon":"","label-position":"left","label-width":"100px"}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.getCard(0)}}},[t._v("逝者信息(1)")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.getCard(1)}}},[t._v("逝者信息(2)")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.SeleteCeme(2)}}},[t._v("重置数据")])],1),t._v(" "),a("el-form-item",{attrs:{label:"选取人数"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:t.SeleteCeme},model:{value:t.type_id,callback:function(e){t.type_id=e},expression:"type_id"}},t._l(t.cemeteryType,(function(t){return a("el-option",{key:t.id,attrs:{label:t.type_name,value:t.hrm}})})),1)],1)],1)],1),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}}),t._v(" "),a("el-form",{ref:"bury",attrs:{inline:!0,"status-icon":"","label-position":"left","label-width":"100px"}},t._l(Number(t.type_id),(function(e,i){return a("div",{key:e},[a("el-form-item",{attrs:{label:"墓主("+(0==i?"1":"2")+")"}},[a("el-input",{model:{value:t.bury[i].vcname,callback:function(e){t.$set(t.bury[i],"vcname",e)},expression:"bury[item].vcname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{model:{value:t.bury[i].sex,callback:function(e){t.$set(t.bury[i],"sex",e)},expression:"bury[item].sex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),t._v(" "),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"籍贯"}},[a("el-input",{model:{value:t.bury[i].nativeplace,callback:function(e){t.$set(t.bury[i],"nativeplace",e)},expression:"bury[item].nativeplace"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"民族"}},[a("el-input",{model:{value:t.bury[i].nation,callback:function(e){t.$set(t.bury[i],"nation",e)},expression:"bury[item].nation"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证"}},[a("el-input",{staticClass:"card",model:{value:t.bury[i].card_no,callback:function(e){t.$set(t.bury[i],"card_no",e)},expression:"bury[item].card_no"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"出生日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.bury[i].birth,callback:function(e){t.$set(t.bury[i],"birth",e)},expression:"bury[item].birth"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"去世日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.bury[i].death,callback:function(e){t.$set(t.bury[i],"death",e)},expression:"bury[item].death"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"安葬日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.bury[i].bury,callback:function(e){t.$set(t.bury[i],"bury",e)},expression:"bury[item].bury"}})],1),t._v(" "),a("br"),t._v(" "),a("el-form-item",{attrs:{label:"身份证(正)"}},[a("div",{staticClass:"uploader_photo dead_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.bury[i].card_photo_z?[a("img",{staticClass:"avatar",attrs:{src:t.bury[i].card_photo_z}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.bury[i].card_photo_z=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(i,1)}}})],2)])]),t._v(" "),a("el-form-item",{attrs:{label:"身份证(反)"}},[a("div",{staticClass:"uploader_photo dead_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.bury[i].card_photo_f?[a("img",{staticClass:"avatar",attrs:{src:t.bury[i].card_photo_f}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.bury[i].card_photo_f=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(i,2)}}})],2)])])],1)})),0)],1)},lt=[],ot=a("a01c"),ct=a("bc3a"),dt=a.n(ct),ut=a("12f9"),mt={components:{card:ut["a"]},mixins:[o["b"],o["a"]],data:function(){return{dialogFormVisible:!1,type_id:2,idx:"",bury:null,cemeteryType:null,index:""}},watch:{cems:{handler:function(t){this.Creattype(),this.SeleteCeme(this.type_id)},immediate:!0}},created:function(){var t=this;this.Creattype();var e={cid:this.cems.id};Object(rt["d"])(e).then((function(e){t.type_id=e.data.type_id}))},methods:{resetForm:function(){this.bury=[{cid:this.cems.id,card_no:"",vcname:"",sex:"",nation:"",nativeplace:"湖北宜昌",card_photo_f:null,card_photo_z:null,cremation_photo:null,death_photo:null,birth:null,death:null,bury:null,type_id:this.type_id}]},SeleteCeme:function(t){this.resetForm();for(var e=0;e<t-1;e++)this.bury.push({cid:this.cems.id,card_no:"",vcname:"",sex:"",nation:"",nativeplace:"湖北宜昌",cremation_photo:null,death_photo:null,card_photo_f:null,card_photo_z:null,birth:null,death:null,bury:null,type_id:this.type_id})},getCard:function(t){var e=this,a="http://127.0.0.1:38088/card=idcard",i="";dt.a.post(a,i).then((function(a){if(0==a.data.code){var i=a.data.IDCardInfo;e.$notify.success({title:"成功",message:"身份信息获取成功"}),e.bury[t].vcname=i.name,e.bury[t].sex=i.sex,e.bury[t].nativeplace=i.address,e.bury[t].card_no=i.cardID,e.bury[t].nation=i.nation;var n=[];n[0]=i.birthday.substring(0,4),n[1]=i.birthday.substring(4,6),n[2]=i.birthday.substring(6,8),e.bury[t].birth=n.join("-")}else e.$notify.error({title:"获取身份信息失败",message:a})})).catch((function(t){e.$notify.error({title:"未检测到系统设备",message:"网络错误"})}))},getPic:function(t,e){this.$refs.cardImg.show(this.bury[t]),this.index=t,this.idx=e},setImg:function(t){1==this.idx?this.bury[this.index].card_photo_z=t:2==this.idx?this.bury[this.index].card_photo_f=t:3==this.idx?this.bury[this.index].cremation_photo=t:this.bury[this.index].death_photo=t},addForm:function(t){var e=this,a=Object.assign({},this.bury),i=[];for(var n in a)i.push(a[n]);i.forEach((function(t,e){if(""===t.vcname){var a=i.indexOf(t);i.splice(a,1)}})),t.dead=i,Object(rt["a"])(t).then((function(t){e.$emit("CloseDialog",!1),e.$message({type:"success",message:"添加购墓信息成功"})})).catch((function(t){e.$message({type:"warning",message:t})}))},Creattype:function(){var t=this,e={cid:this.cems.id};Object(ot["c"])(e).then((function(e){console.log(e.data),t.cemeteryType=e.data.data}))}}},pt=mt,ht=Object(x["a"])(pt,st,lt,!1,null,null,null),ft=ht.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"print",staticStyle:{padding:"30px"}},[a("div",{staticClass:"h1_"},[t._v("公墓墓位使用合同")]),t._v(" "),a("div",{staticClass:"main_"},[t._m(0),t._v(" "),a("strong",[t._v("第一条 合同双方当事人及双方实地查看约定乙方使用墓位")]),t._v(" "),a("table",{staticClass:"table_print"},[a("tr",[a("td",[t._v("出售人（甲方）：快云公墓")]),t._v(" "),a("td",[t._v("购买人（乙方）："+t._s(t.buy.link_name))])]),t._v(" "),a("tr",[a("td",[t._v("法定代表人："+t._s(t.admin_)+" ")]),t._v(" "),a("td",[t._v("住址："+t._s(t.buy.address))])]),t._v(" "),a("tr",[a("td",[t._v("经办人： "+t._s(t.user.realname))]),t._v(" "),a("td",[t._v("身份证号码："+t._s(t.buy.card_no))])]),t._v(" "),a("tr",[a("td",[t._v("地址：宜昌市 ")]),t._v(" "),a("td",[t._v("联系电话："+t._s(t.buy.phone))])]),t._v(" "),a("tr",[a("td",[t._v("公墓建设批准机构：湖北省民政厅 ")]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[a("div",{staticClass:"dead"},[t._v("墓位使用人姓名："+t._s(t.dead1.vcname))]),t._v(" "),a("div",{staticClass:"dead"},[t._v("性别："+t._s(t.dead1.sex))]),t._v(" "),a("div",{staticClass:"dead"},[t._v("身份证号："+t._s(t.dead1.card_no))])])]),t._v(" "),t._m(1),t._v(" "),a("tr",[a("td",[t._v("经营性质：经营性  ")]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[a("div",{staticClass:"dead"},[t._v("墓位使用人姓名："+t._s(t.dead2.vcname))]),t._v(" "),a("div",{staticClass:"dead"},[t._v("性别："+t._s(t.dead2.sex))]),t._v(" "),a("div",{staticClass:"dead"},[t._v("身份证号："+t._s(t.dead2.card_no))])])]),t._v(" "),t._m(2)]),t._v(" "),a("table",{staticClass:"table_print",attrs:{id:"hall_print"}},[a("tr",[a("td",{staticStyle:{width:"2%"}},[t._v("约定墓位")]),t._v(" "),a("td",[t._v("经合同双方实地考察查看，约定乙方使用墓穴位于"),a("u",[t._v(t._s(t.cname))]),t._v("，墓体质地"),a("u",[t._v(t._s(t.cemeterys.texture))]),t._v("，颜色"),a("u",[t._v(t._s(t.cemeterys.colour))]),t._v("，墓穴类型"),a("u",[t._v(t._s(2==t.typeid?"合墓":"单墓"))]),t._v("（一经使用，不得任意改动),面积"),a("u",[t._v(t._s(t.cemeterys.area))]),t._v("平方米。     ")])]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"2%"}},[t._v("约定墓位")]),t._v(" "),a("td",[t._v(" 墓位总价款为："),a("u",[t._v(t._s(t.buy.sell_price))]),t._v("人民币大写：（￥："),a("u",[t._v(t._s(t.dx))]),t._v("）。\n            本合同签订之日，乙方向甲方一次性付清墓位总价款。墓位总价款含墓位使用费建\n            墓工料费、维护管理费。")])]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"2%"}},[t._v("特别约定")]),t._v(" "),a("td",[a("p",[t._v(" 一、乙方依本合同取得墓位使用权，自本合同签订之日起即视为墓位交付乙方使用或双方约定交付时间，使用权年限为20年。即从"),a("u",[t._v(t._s(t.begin[0])+"年"+t._s(t.begin[1])+"月"+t._s(t.begin[2])+"日")]),t._v("到"),a("u",[t._v(t._s(t.end[0])+"年"+t._s(t.end[1])+"月"+t._s(t.end[2])+"日")]),t._v("止")]),t._v(" "),a("p",[t._v(" 二、因甲方管理不善等原因，将乙方已购墓位（未下葬）误销售给第三方的，乙方选择以下任意一项方式进行处理。")]),t._v(" "),t._m(3),t._v(" "),t._m(4)])])]),t._v(" "),a("strong",[t._v("第二条 墓位使用期限届满时需要履行的事宜：")]),t._v(" "),a("p",[t._v("一、按相关规定，公墓土地所有权依法归国家所有。甲方依法开展公墓经营活动，保证乙方在合同期内的合法权益。")]),t._v(" "),a("p",[t._v("二、乙方依本合同取得墓位使用权年限为20年，使用期届满，如乙方需继续使用该墓位时，必须与甲方签订《公墓墓位续用合同》，并按届时规定交付管理维护费。")]),t._v(" "),a("p",[t._v("三、使用期届满的前一年，甲方应书面通知乙方。因乙方通讯方式变更无法联系时，将以登报公告的方式告知。 从乙方收到书面通知或登报公告之日起满一年内，乙方仍不与甲方签订《公墓墓位续用合同》的，视为乙方同意甲方将墓位内骨灰（遗骨）依法集中处理，原双方已签公墓合同视为终止履行，原墓位由甲方依法收回另行处理。")]),t._v(" "),a("strong",[t._v("第三条 甲方责任")]),t._v(" "),t._m(5),t._v(" "),a("p",[t._v("二、因甲方原因造成乙方使用人的墓碑碑文、碑体、碑座等错误或制作、安装过程中有严重损坏的，甲方负责免费更正、更换、安装。")]),t._v(" "),a("strong",[t._v("第四条 乙方责任")]),t._v(" "),a("p",[t._v("一、墓碑：应按甲方设计规划样式加工制作。如乙方要求对墓碑进行特殊处理的，甲方在不影响整体环境的前提下，应满足乙方要求，由此增加的费用，由乙方承担。 ")]),t._v(" "),a("p",[t._v("二、碑文：甲方已按乙方所签碑文的清样或小样制作后，乙方若要求更改内容时，在条件具备的情况下，甲方应尊重、满足乙方要求，但由此产生的一切费用，应仍由乙方承担。")]),t._v(" "),a("p",[t._v("三、乙方因违反甲方的《墓园维护管理规定》造成甲方损失的，应承担赔偿责任。")]),t._v(" "),a("strong",[t._v("第五条 本合同签订后，未经双方书面协商一致，任何一方均不得擅自迁移墓位、调换墓体或者转让给他人使用。乙方要求迁移使用人骨灰时，应书面通知甲方，并由乙方亲自办理相关手续（若乙方无法亲自办理，须履行相关委托手续后由受委托人办理），乙方迁移骨灰后，即视同乙方放弃该墓位的使用权，双方合同终止。")]),a("br"),t._v(" "),a("strong",[t._v("第六条 因不可抗力因素造成墓体损毁、骨灰毁失、碑体损坏时，甲方不承担法律责任。甲方可采取登报公告或书面、电话等方式通知乙方，并采取有效措施降低、减少损失。甲方未尽到通知义务的，应承担相应的赔偿责任。墓碑因自然风化造成碑文风化脱落，合同期内由甲方书面通知乙方后，协商更换；合同续存期外，责任由乙方自行承担。")]),a("br"),t._v(" "),a("strong",[t._v("第七条 本合同在履行过程中若发生争议，可由双方当事人协商解决，协商不成，任一方有权向人民法院诉讼解决纠纷。")]),a("br"),t._v(" "),a("strong",[t._v("第八条 本合同未尽事宜，由双方约定后，可作为本合同的附件，具有同等法律效力。")]),a("br"),t._v(" "),a("strong",[t._v("第九条 本合同一式叁份。甲方贰份，乙方壹份。")]),a("br"),t._v(" "),a("strong",[t._v("第十条 本合同自双方签字并支付全款之日生效。")]),a("br"),t._v(" "),t._m(6),t._v(" "),a("div",{staticStyle:{"text-align":"right"}},[t._v("签订日期: "+t._s(t.currentdate))])])])])},vt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("strong",{staticStyle:{"line-height":"30px"}},[t._v("根据《中华人民共和国合同法》以及国务院办公室转发民政部《关于进一步加强公墓管理的通知》（国办【1998】25号）规定等有关法律、法规之规定，经双方协商，现就购买、使用墓位相关事项达成如下协议：")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("批准文号：【1994】鄂民政字7号 ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("联系电话：0717--7891607")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("1.甲方退还乙方所购墓位款项，并向乙方支付合同总价款"),a("u",[t._v("2 %")]),t._v("的违约金。")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("2.甲方在规划区内，向乙方提供同等墓型、同等材质，同等数量的墓位，并向乙方支付合同总价款"),a("u",[t._v("2%")]),t._v("的违约金。")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[t._v("一、甲方未按本合同约定要求交付墓位给乙方安葬使用，甲方应自接到乙方书面通知之日起15天内履行约定事项，违约金按日计算至甲方书面通知交付之日止，每日按本合同总价款的"),a("u",[t._v("2‰")]),t._v("计算。")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"flex","justify-content":"space-between",height:"60px","line-height":"60px",padding:"0 0 0 0px"}},[a("div",[t._v(" 出售人盖章: "),a("div",{staticStyle:{display:"inline-block","border-bottom":"1px solid #000",width:"130px","text-align":"center",height:"20px","line-height":"20px"}},[t._v("快云公墓")])]),t._v(" "),a("div",[t._v(" 购墓人签字或盖章: "),a("div",{staticStyle:{display:"inline-block","border-bottom":"1px solid #000",width:"130px","text-align":"center",height:"20px","line-height":"20px"}})])])}],gt=(a("a481"),a("28a5"),a("8194")),bt=a("ed08"),yt={mixins:[o["b"]],data:function(){return{list:{},begin:[],end:[],typeid:"",end1:[],ewm:"",admin_:"",dx:"",dead1:{vcname:"",sex:"",card_no:""},dead2:{vcname:"",sex:"",card_no:""},cemeterys:{},cemetery:{},buy:{},orders:{sellname:""},currentdate:""}},created:function(){this.getNowFormatDate()},methods:{print:function(){this.$print(this.$refs.print)},init:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={cid:e.cid},this.typeid=e.typeid,t.next=4,E(a).then((function(t){i.dead1=t.data[0],t.data[1]&&(i.dead2=t.data[1])}));case 4:return t.next=6,Object(gt["b"])().then((function(t){t.data.data.forEach((function(t){2==t.id&&(i.admin_=t.realname)}))}));case 6:return t.next=8,Object(l["a"])(a).then((function(t){i.cemeterys=t.data.cemeteryData}));case 8:return t.next=10,Object(rt["f"])(e).then((function(t){i.buy=t.data[0],i.begin=i.buy.order_begin.split("-"),i.end=i.buy.order_end.split("-");var e=new Date(i.buy.order_begin);e.setFullYear(e.getFullYear()+3),e.setDate(e.getDate());var a=Object(bt["d"])(e,"{y}-{m}-{d}");i.end1=a.split("-"),i.dx=i.digitUppercase(i.buy.sell_price),i.$nextTick((function(){i.print()}))}));case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),digitUppercase:function(t){var e=["角","分"],a=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],i=[["元","万","亿"],["","拾","佰","仟"]],n=t<0?"欠":"";t=Math.abs(t);for(var r="",s=0;s<e.length;s++)r+=(a[Math.floor(10*t*Math.pow(10,s))%10]+e[s]).replace(/零./,"");r=r||"整",t=Math.floor(t);for(s=0;s<i[0].length&&t>0;s++){for(var l="",o=0;o<i[1].length&&t>0;o++)l=a[t%10]+i[1][o]+l,t=Math.floor(t/10);r=l.replace(/(零.)*零$/,"").replace(/^$/,"零")+i[0][s]+r}return n+r.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")},getNowFormatDate:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),this.currentdate=e+"年"+a+"月"+i+"日"}}},Ft=yt,xt=(a("8996"),Object(x["a"])(Ft,_t,vt,!1,null,"bdfc1f28",null)),kt=xt.exports,wt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"print",staticStyle:{width:"900px"}},[a("h3",{staticClass:"print_title"},[t._v("购墓申请单")]),t._v(" "),a("table",{staticClass:"table_print",staticStyle:{width:"900px"},attrs:{id:"hall_print"}},[a("tr",[t._m(0),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v("姓名")]),t._v(" "),a("td",{staticStyle:{width:"90px"},attrs:{rowspan:"2"}},[t._v(t._s(t.dead1.vcname))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v(t._s(t.dead1.sex))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v("证件号码")]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v(t._s(t.dead1.card_no))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v("籍贯")]),t._v(" "),a("td",{attrs:{rowspan:"2"}}),t._v(" "),a("td",[t._v("死亡日期")]),t._v(" "),a("td",[t._v(t._s(t.dead1.death))])]),t._v(" "),a("tr",[a("td",[t._v("安葬日期")]),t._v(" "),a("td",[t._v(t._s(t.dead1.bury))])]),t._v(" "),a("tr",[a("td",{attrs:{rowspan:"2"}},[t._v("姓名")]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v(t._s(t.dead2.vcname))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v(t._s(t.dead2.sex))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v("证件号码")]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v(t._s(t.dead2.card_no))]),t._v(" "),a("td",{attrs:{rowspan:"2"}},[t._v("籍贯")]),t._v(" "),a("td",{attrs:{rowspan:"2"}}),t._v(" "),a("td",[t._v("死亡日期")]),t._v(" "),a("td",[t._v(t._s(t.dead2.death))])]),t._v(" "),a("tr",[a("td",[t._v("安葬日期")]),t._v(" "),a("td",[t._v(t._s(t.dead2.bury))])]),t._v(" "),a("tr",[t._m(1),t._v(" "),a("td",[t._v("姓名")]),t._v(" "),a("td",[t._v(t._s(t.list.link_name))]),t._v(" "),a("td",[t._v("关系")]),t._v(" "),a("td",[t._v(t._s(t.list.relation))]),t._v(" "),a("td",[t._v("证件号码")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.list.card_no))]),t._v(" "),a("td",[t._v("联系电话")]),t._v(" "),a("td",[t._v(t._s(t.list.phone))])]),t._v(" "),a("tr",[a("td",[t._v("备注")]),t._v(" "),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.list.vcnote))]),t._v(" "),a("td",[t._v("住址")]),t._v(" "),a("td",{attrs:{colspan:"5"}},[a("div",{staticStyle:{position:"absolute",top:"180px"}},[t._v(t._s(t.list.address))])])]),t._v(" "),t._m(2),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[t._v("墓位区号")]),t._v(" "),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.cemetery.areaname+t.cemetery.cname))]),t._v(" "),a("td",[t._v("墓型")]),t._v(" "),a("td",[t._v(t._s(t.buy.sell_price))]),t._v(" "),a("td",[t._v("发票号码")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.buy.fph))])]),t._v(" "),a("tr",[a("td",{attrs:{colspan:"2"}},[t._v("颜色")]),t._v(" "),a("td",{attrs:{colspan:"3"}},[t._v(t._s(t.cemetery.colour))]),t._v(" "),a("td",[t._v("石材种类")]),t._v(" "),a("td",[t._v(t._s(t.cemetery.texture))]),t._v(" "),a("td",[t._v("购墓日期")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v(t._s(t.buy.order_begin))])]),t._v(" "),a("tr",[a("td",{staticStyle:{width:"100px"},attrs:{colspan:"2"}},[t._v("墓地面积")]),t._v(" "),a("td",{attrs:{colspan:"5"}},[t._v(t._s(t.cemetery.area)+" 平方米")]),t._v(" "),a("td",[t._v("服务年限")]),t._v(" "),a("td",{attrs:{colspan:"2"}},[t._v("20年")])])]),t._v(" "),a("div",{staticClass:"prinr_foot"},[a("span",{staticStyle:{"font-size":"18px"}},[t._v("经办人:"+t._s(t.user.realname))]),t._v(" "),a("span",{staticStyle:{"font-size":"18px"}},[t._v(t._s(t.currentdate))])])])])},$t=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{attrs:{rowspan:"4"}},[a("div",{staticStyle:{width:"10px","padding-left":"7px","line-height":"20px!important"}},[t._v("使用人")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",{staticStyle:{width:"30px"},attrs:{rowspan:"2"}},[a("div",{staticStyle:{width:"10px","padding-left":"7px","line-height":"20px!important"}},[t._v("申请人")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",{staticStyle:{"font-size":"18px",height:"30px","line-height":"30px","font-weight":"800"},attrs:{colspan:"10"}},[t._v("以下由经办人填写")])])}],Ct={mixins:[o["b"]],data:function(){return{dead1:{vcname:"",card:"",birth:null,death:null,bury:null,sex:""},dead2:{vcname:"",card:"",birth:null,death:null,bury:null,sex:""},cemetery:{},buy:{},list:{link_name:"",relation:"",card_no:"",address:"",phone:""},server:null,currentdate:"",totalprice:""}},computed:{},created:function(){this.getNowFormatDate()},methods:{print:function(){this.$print(this.$refs.print)},getlist:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(e){var a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,E(e).then((function(t){a.dead1=t.data[0],a.dead2={sex:"",vcname:"",birth2:null,death2:null,bury2:null},t.data[1]&&(a.dead2=t.data[1])}));case 2:return t.next=4,_(e).then((function(t){a.list=t.data[0]}));case 4:return t.next=6,Object(l["a"])(e).then((function(t){a.cemetery=t.data.cemeteryData}));case 6:return t.next=8,Object(rt["f"])(e).then((function(t){a.buy=t.data[0]}));case 8:return t.next=10,this.print();case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),getNowFormatDate:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),this.currentdate=e+"年"+a+"月"+i+"日"}}},St=Ct,jt=(a("caa9"),Object(x["a"])(St,wt,$t,!1,null,"455f01b9",null)),Ot=jt.exports,Lt={components:{VueForm:ft,contract:kt,reserver:Ot,card:ut["a"]},mixins:[o["b"],o["a"]],data:function(){return{index:1,flag:"",idx:"",dataFormEdit:!0,list:null,type_id:2,listlink:null,listLoading:!0,dialogFormVisible:!1,dialogFormVisiblegm:!1,dialogStatus:"",dataForm:{cid:"",order_begin:null,order_end:null,real_price:"",buyer_name:"",fph:"",dabh:"",sell_price:"",card_photo_z:"",card_photo_f:"",phone:"",card_no:"",relation:"",sellname:"",seller_id:"",address:"",vcdesc:"",financetype:2,dead:[]},rules:{real_price:[{required:!0,message:"实收金额不能为空",trigger:"change"}]}}},computed:{},watch:{cems:{handler:function(t){this.getList()},immediate:!0},order:{handler:function(t){t===this.index&&this.getList()},immediate:!0}},created:function(){},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};Object(rt["f"])(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},getPic:function(t){this.idx=t,this.$refs.cardImg.show()},setImg:function(t){1==this.idx?this.dataForm.card_photo_z=t:this.dataForm.card_photo_f=t},handleBury:function(){var t=this;this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0,this.dataFormEdit=!0;var e=new Date(this.dataForm.order_begin);e.setFullYear(e.getFullYear()+20),e.setDate(e.getDate()),this.dataForm.order_begin=Object(bt["d"])(this.dataForm.order_begin,"{y}-{m}-{d}"),this.dataForm.order_end=Object(bt["d"])(e,"{y}-{m}-{d}"),this.dataForm.sell_price=this.cems.sellprice,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},createData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&t.$refs.child.addForm(t.dataForm)}))},refresh:function(){this.getList()},changedate:function(){var t=new Date(this.dataForm.order_begin);t.setFullYear(t.getFullYear()+20),t.setDate(t.getDate()),this.dataForm.order_begin=Object(bt["d"])(this.dataForm.order_begin,"{y}-{m}-{d}"),this.dataForm.order_end=Object(bt["d"])(t,"{y}-{m}-{d}")},handleUpdate:function(t){var e=this;this.dataForm=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.dataFormEdit=!1,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&Object(rt["c"])(t.dataForm).then((function(e){t.getList(),t.$emit("v"),t.dialogFormVisible=!1,t.$message({type:"success",message:"更新购墓信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},handleDelete:function(t){var e=this;this.$confirm("是否删除?","删除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id,cid:t.cid,financetype:t.financetype};Object(rt["b"])(a).then((function(a){e.$message({type:"success",message:"删除购墓信息成功"});var i=e.list.indexOf(t);e.list.splice(i,1),e.$emit("v")})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},getCard:function(){var t=this,e="http://127.0.0.1:38088/card=idcard",a="";dt.a.post(e,a).then((function(e){if(0==e.data.code){var a=e.data.IDCardInfo;t.$notify.success({title:"成功",message:"身份信息获取成功"}),t.dataForm.buyer_name=a.name,t.dataForm.card_no=a.cardID,t.dataForm.address=a.address}else t.$notify.error({title:"获取身份信息失败",message:e})})).catch((function(e){t.$notify.error({title:"未检测到系统设备",message:"网络错误"})}))},CloseDialog:function(t){this.dialogFormVisible=!1,this.getList(),this.$emit("v")},CemeteryPrint:function(){var t={cid:this.cems.id};this.$refs.reserver_.getlist(t)},handlePay:function(){var t=this;this.$confirm("打印合同后视为售出且购墓信息将无法删除, 是否继续?","打印操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var e={cid:t.cems.id,typeid:t.typeid};t.$refs.contract_.init(e),Object(rt["g"])(e).then((function(e){t.$emit("v")})).catch((function(e){t.$message({type:"warning",message:e})}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},resetForm:function(){this.dataForm={cid:this.cems.id,order_begin:new Date,order_end:null,real_price:"",buyer_name:"",card_no:"",fph:"",dabh:"",card_photo_z:"",card_photo_f:"",phone:"",relation:"",address:"",vcdesc:"",sellname:this.user.realname,seller_id:this.user.id,financetype:2}}}},Vt=Lt,zt=Object(x["a"])(Vt,it,nt,!1,null,null,null),Dt=zt.exports,Tt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("el-button",{staticClass:"filter-item",staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-edit",disabled:!(t.cname.type_id>(t.list?t.list.length:2))},on:{click:t.handleBury}},[t._v("添加墓主信息")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"姓名",prop:"vcname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"性别",prop:"sex",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"出生日期",prop:"birth"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"去世日期",prop:"death"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"安葬日期",prop:"bury"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态",prop:"bury_status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("bury_status")(e.row.bury_status)}},[t._v(t._s(0==e.row.bury_status?"未安葬":"已安葬"))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.bury_status?a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return t.GoBury(e.row)}}},[t._v("安葬")]):a("el-button",{attrs:{type:"info",size:"mini",plain:"",disabled:""}},[t._v("已安葬")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.photoSearch(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{staticStyle:{margin:"5px 0 0 0"},attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),0==e.row.bury_status?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:"查看",visible:t.searchVisible,top:"5vh",width:"420px","append-to-body":""},on:{"update:visible":function(e){t.searchVisible=e}}},[a("div",{staticClass:"card_photo"},[a("div",{staticClass:"uploader_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.card_photo_z.card_photo?[a("el-image",{staticClass:"avatar",attrs:{src:t.card_photo_z.card_photo}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.getPic(1)}}},[a("i",{staticClass:"el-icon-edit"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.photoDel(t.card_photo_z)}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(1)}}})],2),t._v(" "),a("p",[t._v("身份证(正)")])]),t._v(" "),a("div",{staticClass:"uploader_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.card_photo_f.card_photo?[a("el-image",{staticClass:"avatar",attrs:{src:t.card_photo_f.card_photo}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.getPic(2)}}},[a("i",{staticClass:"el-icon-edit"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.photoDel(t.card_photo_f)}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(2)}}})],2),t._v(" "),a("p",[t._v("身份证(反)")])])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.searchVisible=!1}}},[t._v("取消")])],1)]),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}}),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{id:"dead","close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.getCard()}}},[t._v("逝者信息")])],1),t._v(" "),a("el-form",{ref:"dataForm",staticStyle:{width:"600px","margin-left":"50px"},attrs:{inline:!0,rules:t.rules,"status-icon":"","label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"墓主"}},[a("el-input",{model:{value:t.dataForm.vcname,callback:function(e){t.$set(t.dataForm,"vcname",e)},expression:"dataForm.vcname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"性别"}},[a("el-select",{model:{value:t.dataForm.sex,callback:function(e){t.$set(t.dataForm,"sex",e)},expression:"dataForm.sex"}},[a("el-option",{attrs:{label:"男",value:"男"}}),t._v(" "),a("el-option",{attrs:{label:"女",value:"女"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证"}},[a("el-input",{model:{value:t.dataForm.card_no,callback:function(e){t.$set(t.dataForm,"card_no",e)},expression:"dataForm.card_no"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"籍贯"}},[a("el-input",{model:{value:t.dataForm.nativeplace,callback:function(e){t.$set(t.dataForm,"nativeplace",e)},expression:"dataForm.nativeplace"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"民族"}},[a("el-input",{model:{value:t.dataForm.nation,callback:function(e){t.$set(t.dataForm,"nation",e)},expression:"dataForm.nation"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"出生日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.birth,callback:function(e){t.$set(t.dataForm,"birth",e)},expression:"dataForm.birth"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"去世日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.death,callback:function(e){t.$set(t.dataForm,"death",e)},expression:"dataForm.death"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"安葬日期"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.bury,callback:function(e){t.$set(t.dataForm,"bury",e)},expression:"dataForm.bury"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1)],1)},Et=[],Mt={components:{card:ut["a"]},mixins:[o["b"],o["a"]],data:function(){return{n:"",index:1,list:null,card_photo_z:{card_photo:"",id:"",images_name:"身份证(正)",type:2,imgtype:1,step:1,cid:"",tid:""},card_photo_f:{card_photo:"",id:"",images_name:"身份证(反)",type:2,imgtype:1,step:2,cid:"",tid:""},listLoading:!0,searchVisible:!1,dialogFormVisible:!1,cemeteryType:null,dialogStatus:"",dataForm:{cid:"",card_no:"",vcname:"",nation:"汉",nativeplace:"",sex:"",birth:null,death:null,bury:null},buryForm:null,rules:{}}},watch:{cems:{handler:function(t){this.getList(),this.getStatus()},immediate:!0}},created:function(){},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};E(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},refresh:function(){this.getList()},getCard:function(t){var e=this,a="http://127.0.0.1:38088/card=idcard",i="";dt.a.post(a,i).then((function(t){if(0==t.data.code){var a=t.data.IDCardInfo;e.$notify.success({title:"成功",message:"身份信息获取成功"}),e.dataForm.vcname=a.name,e.dataForm.sex=a.sex,e.dataForm.nativeplace=a.address,e.dataForm.card_no=a.cardID;var i=[];i[0]=a.birthday.substring(0,4),i[1]=a.birthday.substring(4,6),i[2]=a.birthday.substring(6,8),e.dataForm.birth=i.join("-")}else e.$notify.error({title:"获取身份信息失败",message:t})})).catch((function(t){e.$notify.error({title:"未检测到系统设备",message:"网络错误"})}))},getPic:function(t){this.$refs.cardImg.show(),this.n=t},setImg:function(t){this.photo(t)},photo:function(t){var e=this.n;switch(e){case 1:this.card_photo_z.card_photo=t,this.dispose(this.card_photo_z);break;case 2:this.card_photo_f.card_photo=t,this.dispose(this.card_photo_f);break;default:}},dispose:function(t){var e=this;q(t).then((function(a){e.$message({type:"success",message:"更新成功"}),t.id=a.data})).catch((function(t){e.$message({type:"warning",message:t})}))},handleBury:function(){this.dialogStatus="create",this.dialogFormVisible=!0,this.resetForm()},handleUpdate:function(t){this.dataForm=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0},updateData:function(){var t=this;I(this.dataForm).then((function(){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"更新墓主信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))},photoDel:function(t){var e=this;this.$confirm("是否删除?","删除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id};N(a).then((function(a){e.$message({type:"success",message:"删除成功"}),t.card_photo="",t.id=""}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},photoSearch:function(t){var e=this,a={cid:t.cid,tid:t.id,imgtype:1};this.resetForm(),this.card_photo_z.cid=t.cid,this.card_photo_z.tid=t.id,this.card_photo_f.cid=t.cid,this.card_photo_f.tid=t.id,B(a).then((function(t){t.data.forEach((function(t){1==t.step?(e.card_photo_z.card_photo=t.photo,e.card_photo_z.id=t.id):(e.card_photo_f.card_photo=t.photo,e.card_photo_f.id=t.id)})),e.searchVisible=!0}))},handleDelete:function(t){var e=this;this.$confirm("是否删除?","删除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id,cid:e.cems.id};Q(a).then((function(a){e.$message({type:"success",message:"删除成功"});var i=e.list.indexOf(t);e.list.splice(i,1)})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},GoBury:function(t){var e=this,a={id:t.id,bury:t.bury};this.$confirm("是否安葬?","安葬操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){P(a).then((function(t){e.$emit("v"),e.$message({type:"success",message:"操作成功"}),e.getList()})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},createData:function(){var t=this;this.dataForm.cid=this.cems.id,M(this.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加墓主信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))},resetForm:function(){this.dataForm={cid:this.cems.id,card_no:"",vcname:"",sex:"",birth:null,death:null,nativeplace:"",cremation_photo:null,death_photo:null,bury:null},this.card_photo_z={card_photo:"",id:"",images_name:"身份证(正)",type:2,imgtype:1,step:1,cid:"",tid:""},this.card_photo_f={card_photo:"",id:"",images_name:"身份证(反)",type:2,imgtype:1,step:2,cid:"",tid:""}}}},It=Mt,Qt=(a("a471"),Object(x["a"])(It,Tt,Et,!1,null,null,null)),Pt=Qt.exports,Bt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("el-button",{staticClass:"filter-item",staticStyle:{margin:"10px 0"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handlelink}},[t._v("增加联系人")]),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"姓名",prop:"link_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"电话",prop:"phone"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"关系",prop:"relation"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"住址",prop:"address"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdatelink(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleSearch(e.row)}}},[t._v("查看")]),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:1!=e.row.c_sure,expression:"scope.row.c_sure != 1"}],staticStyle:{margin:"5px 0 0 0"},attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDeletelink(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}}),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"append-to-body":"",top:"5vh"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.getCard()}}},[t._v("联系人信息")])],1),t._v(" "),a("div",{staticClass:"linkman"},[a("el-form",{ref:"dataForm",staticClass:"dataFormman",staticStyle:{"margin-left":"50px"},attrs:{inline:!0,rules:t.rules,model:t.dataForm,"status-icon":"","label-position":"left","label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"link_name"}},[a("el-input",{model:{value:t.dataForm.link_name,callback:function(e){t.$set(t.dataForm,"link_name",e)},expression:"dataForm.link_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"phone"}},[a("el-input",{model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证",prop:"card_no"}},[a("el-input",{model:{value:t.dataForm.card_no,callback:function(e){t.$set(t.dataForm,"card_no",e)},expression:"dataForm.card_no"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"关系",prop:"relation"}},[a("el-input",{model:{value:t.dataForm.relation,callback:function(e){t.$set(t.dataForm,"relation",e)},expression:"dataForm.relation"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"住址",prop:"address"}},[a("el-input",{model:{value:t.dataForm.address,callback:function(e){t.$set(t.dataForm,"address",e)},expression:"dataForm.address"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createDatalink}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateDatalink}},[t._v("确定")])],1)]),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:"查看",visible:t.searchVisible,top:"5vh",width:"420px","append-to-body":""},on:{"update:visible":function(e){t.searchVisible=e}}},[a("div",{staticClass:"card_photo"},[a("div",{staticClass:"uploader_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.dataForm.card_photo_z?[a("img",{staticClass:"avatar",attrs:{src:t.dataForm.card_photo_z}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.dataForm.card_photo_z=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(1)}}})],2),t._v(" "),a("p",[t._v("身份证(正)")])]),t._v(" "),a("div",{staticClass:"uploader_photo"},[a("div",{staticClass:"avatar-uploader el-upload-list--picture-card"},[t.dataForm.card_photo_f?[a("img",{staticClass:"avatar",attrs:{src:t.dataForm.card_photo_f}}),t._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-preview"},[a("i",{staticClass:"el-icon-zoom-in"})]),t._v(" "),a("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){t.dataForm.card_photo_f=""}}},[a("i",{staticClass:"el-icon-delete"})])])]:a("i",{staticClass:"el-icon-plus avatar-uploader-icon",on:{click:function(e){return t.getPic(2)}}})],2),t._v(" "),a("p",[t._v("身份证(反)")])])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.searchVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.updatePhoto}},[t._v("保存")])],1)])],1)},Nt=[],qt={components:{card:ut["a"]},mixins:[o["b"]],data:function(){return{index:1,idx:"",list:null,listLoading:!0,searchVisible:!1,dialogFormVisible:!1,dialogStatus:"",dataForm:{cid:"",link_name:"",phone:"",card_no:"",card_photo_z:"",card_photo_f:"",relation:"",address:""},rules:{link_name:[{required:!0,message:"联系人姓名不能为空",trigger:"blur"}]}}},watch:{cems:{handler:function(t){this.getList()},immediate:!0}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};_(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},refresh:function(){this.getList()},getPic:function(t){this.$refs.cardImg.show(this.dataForm),this.idx=t},setImg:function(t){1==this.idx?this.dataForm.card_photo_z=t:this.dataForm.card_photo_f=t},handlelink:function(){var t=this;this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},resetForm:function(){this.dataForm={cid:"",link_name:"",phone:"",card_no:"",relation:"",address:""}},createDatalink:function(){var t=this;this.dataForm.cid=this.cems.id,this.$refs["dataForm"].validate((function(e){e&&v(t.dataForm).then((function(e){t.list.unshift(e.data),t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加联系人成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},getCard:function(t){var e=this,a="http://127.0.0.1:38088/card=idcard",i="";dt.a.post(a,i).then((function(t){if(0==t.data.code){var a=t.data.IDCardInfo;e.$notify.success({title:"成功",message:"身份信息获取成功"}),e.dataForm.link_name=a.name,e.dataForm.address=a.address,e.dataForm.card_no=a.cardID}else e.$notify.error({title:"获取身份信息失败",message:t})})).catch((function(t){e.$notify.error({title:"未检测到系统设备",message:"网络错误"})}))},handleSearch:function(t){this.searchVisible=!0,this.dataForm=Object.assign({},t)},handleUpdatelink:function(t){var e=this;this.dataForm=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},updatePhoto:function(){},updateDatalink:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&g(t.dataForm).then((function(){1==t.dataForm.c_sure&&(t.$emit("v"),console.log(2)),t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"更新联系人成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},handleDeletelink:function(t){var e=this;this.$confirm("是否删除?","删除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id,cid:t.cid};b(a).then((function(a){e.$message({type:"success",message:"删除联系人成功"});var i=e.list.indexOf(t);e.list.splice(i,1)})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))}}},Rt=qt,Ut=Object(x["a"])(Rt,Bt,Nt,!1,null,"528fbb1c",null),Yt=Ut.exports,At={components:{buy:Dt,dead:Pt,linkman:Yt},data:function(){return{}},methods:{v:function(){this.$emit("v"),this.$refs.buy.refresh(),this.$refs.dead.refresh(),this.$refs.linkman.refresh()}}},Ht=At,Gt=Object(x["a"])(Ht,et,at,!1,null,"215fa7aa",null),Jt=Gt.exports,Xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{disabled:2==t.cname.usestatus,type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加预定信息")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"预定人",prop:"buyer_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系电话",prop:"phone"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"开始时间",prop:"order_begin"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"到期时间",prop:"order_end"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"预定金额",prop:"real_price"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"sellname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"预定状态",prop:"guoqi_status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("or_status")(e.row.guoqi_status)}},[t._v(t._s(e.row.guoqi_days))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-refresh-left"},on:{click:function(a){return t.handlePay(e.row)}}},[t._v("退款")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!0,rules:t.rules,"status-icon":"",model:t.dataForm,"label-position":"left","label-width":"120px"}},[a("el-form-item",{attrs:{label:"预定人",prop:"buyer_name"}},[a("el-input",{model:{value:t.dataForm.buyer_name,callback:function(e){t.$set(t.dataForm,"buyer_name",e)},expression:"dataForm.buyer_name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[a("el-input",{model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"order_begin"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.order_begin,callback:function(e){t.$set(t.dataForm,"order_begin",e)},expression:"dataForm.order_begin"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"order_end"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.order_end,callback:function(e){t.$set(t.dataForm,"order_end",e)},expression:"dataForm.order_end"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"预定金额",prop:"real_price"}},[a("el-input",{model:{value:t.dataForm.real_price,callback:function(e){t.$set(t.dataForm,"real_price",t._n(e))},expression:"dataForm.real_price"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1)],1)},Kt=[],Wt=a("5c54"),Zt={mixins:[o["b"],o["a"]],data:function(){return{index:0,list:null,listLoading:!0,dialogStatus:"",dataForm:{cid:"",buyer_name:"",order_begin:"",order_end:"",phone:"",real_price:"",sellname:"",seller_id:"",financetype:1},dialogFormVisible:!1,rules:{buyer_name:[{required:!0,message:"预定人不能为空",trigger:"blur"}],order_begin:[{required:!0,message:"请选择日期",trigger:"change"}],order_end:[{required:!0,message:"请选择日期",trigger:"change"}]}}},watch:{cems:{handler:function(t){this.getList()}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!1;var e={cid:this.cems.id};Object(Wt["d"])(e).then((function(e){t.list=e.data.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},resetForm:function(){this.dataForm={cid:this.cems.id,buyer_name:"",order_begin:new Date,order_end:"",phone:"",real_price:"",sellname:this.user.realname,seller_id:this.user.id,financetype:1}},handleCreate:function(){var t=this;this.resetForm();var e=new Date(this.dataForm.order_begin);e.setDate(e.getDate()+4),this.dataForm.order_end=Object(bt["d"])(e,"{y}-{m}-{d}"),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},createData:function(){var t=this;this.dataForm.order_begin=Object(bt["d"])(this.dataForm.order_begin,"{y}-{m}-{d}"),this.$refs["dataForm"].validate((function(e){e&&Object(Wt["b"])(t.dataForm).then((function(e){t.getList(),t.$emit("v"),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加预定信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&(delete t.dataForm["guoqi_days"],delete t.dataForm["guoqi_status"],Object(Wt["f"])(t.dataForm).then((function(e){t.dialogFormVisible=!1,t.getList(),t.$message({type:"success",message:"更新预定信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})})))}))},handleUpdate:function(t){var e=this;this.dataForm=Object.assign({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handlePay:function(t){var e=this,a={id:t.id,cid:t.cid,financetype:t.financetype};this.$confirm("是否退款?","操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){Object(Wt["e"])(a).then((function(t){e.$message({type:"success",message:"退款成功"}),e.getList(),e.$emit("v")})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},handleDelete:function(t){var e=this,a={id:t.id,cid:t.cid,financetype:t.financetype};this.$confirm("是否删除?","操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){Object(Wt["c"])(a).then((function(t){e.$message({type:"success",message:"删除成功"}),e.getList(),e.$emit("v")})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))}}},te=Zt,ee=Object(x["a"])(te,Xt,Kt,!1,null,null,null),ae=ee.exports,ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[1!=t.currentStatus?a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加点灯服务")]):a("el-button",{attrs:{type:"info",plain:"",disabled:""}},[t._v("点灯已锁定")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"订单号",prop:"order_no"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"购买人",prop:"buyname",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"电话",prop:"phone",width:"120"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"点灯时间",prop:"lamp_nd",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticStyle:{"font-size":"18px",color:"red"}},[t._v("\n          "+t._s(e.row.lamp_nd)+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"付款状态",prop:"order_status"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("or_status")(e.row.order_status)}},[t._v("\n          "+t._s(1==e.row.order_status?"未付款":"已付款")+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.order_status?[a("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(a){return t.handlePay(e.row)}}},[t._v("付款")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]:[a("el-button",{attrs:{type:"info",size:"mini",plain:"",disabled:""}},[t._v("已完结")])],t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.lampPrint(e.row)}}},[t._v("打印")])]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!0,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"墓穴名称"}},[a("span",{staticClass:"tag"},[t._v(t._s(t.cname))])]),t._v(" "),a("el-form-item",{attrs:{label:"费用"}},[a("span",{staticClass:"tag",staticStyle:{color:"red"}},[t._v(t._s(t.dataForm.real_price)+" 元")])]),t._v(" "),a("el-form-item",{attrs:{label:"购买人",prop:"buyname"}},[a("el-input",{model:{value:t.dataForm.buyname,callback:function(e){t.$set(t.dataForm,"buyname",e)},expression:"dataForm.buyname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"联系电话",prop:"phone"}},[a("el-input",{model:{value:t.dataForm.phone,callback:function(e){t.$set(t.dataForm,"phone",e)},expression:"dataForm.phone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"身份证",prop:"sfz"}},[a("el-input",{model:{value:t.dataForm.card_no,callback:function(e){t.$set(t.dataForm,"card_no",e)},expression:"dataForm.card_no"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"点灯时间"}},[a("el-input",{model:{value:t.dataForm.buydate,callback:function(e){t.$set(t.dataForm,"buydate",e)},expression:"dataForm.buydate"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"*注:"}},[a("div",{staticStyle:{color:"red","font-size":"13px"}},[t._v(" 选择"+t._s(t.dataForm.buydate)+"年代表年"+t._s(t.dataForm.buydate)+"年春节点灯")])])],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1),t._v(" "),a("plamp",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"plamp_"})],1)},ne=[];function re(t){return Object(f["a"])({url:"/order/lightup_list_byid",method:"get",params:t})}function se(t){return Object(f["a"])({url:"/order/lightup_add",method:"post",data:t})}function le(t){return Object(f["a"])({url:"/order/buy_cemetery_del",method:"get",params:t})}function oe(t){return Object(f["a"])({url:"/order/lightup_edit",method:"post",data:t})}function ce(t){return Object(f["a"])({url:"/order/lightup_pay",method:"post",data:t})}var de=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{ref:"print",staticStyle:{"padding-right":"10px"}},[t._m(0),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[t._v(t._s(t.currentdate))]),t._v(" "),a("div",{staticClass:"lamp_print"},[a("div",{staticClass:"lamp_border"},[t._v("\n        今收到\n      ")]),t._v(" "),a("div",{staticStyle:{"padding-left":"40px",position:"absolute",height:"40px","line-height":"40px"}},[t._v("\n        "+t._s(t.list.buryname)+t._s(t.list.cname)+t._s(t.list.lamp_nd)+"年春节点灯（"+t._s(t.list.vcnote)+"共计"+t._s(t.list.daycount)+"天）\n      ")]),t._v(" "),a("div",{staticStyle:{height:"40px"}}),t._v(" "),a("div",{staticClass:"lamp_border",staticStyle:{"border-top":"1px dashed #000"}},[t._v("\n        金额（大写）:"+t._s(t.dx)+"\n      ")]),t._v(" "),t._m(1)]),t._v(" "),a("div",{staticClass:"prinr_foot"},[a("span",[t._v("收款单位:宜昌市夷陵区凌霄园公墓")]),t._v(" "),a("span",[t._v("经办人:"+t._s(t.operate))])])])])},ue=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("h3",{staticClass:"print_title"},[a("u",[t._v("春 节 送 灯 收 款 收 据")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"note"},[a("p",[t._v("温馨提示:")]),t._v(" "),a("p",{staticStyle:{display:"inline-block","padding-left":"55px"}},[t._v("需点灯祭祀的市民，请务必在每年的正月十六至腊月二十五办理点灯缴费手续， ")]),t._v(" "),a("p",[t._v("过期将不在办理。")])])}],me={mixins:[o["b"]],data:function(){return{list:{},dx:"",operate:""}},computed:{},created:function(){this.getNowFormatDate()},methods:{print:function(){this.$print(this.$refs.print)},getlist:function(t){var e=this;this.list=t.list,this.name=t.name,this.operate=t.operate,this.dx=this.digitUppercase(this.list.real_price),this.$nextTick((function(){e.print()}))},rest:function(){},getNowFormatDate:function(){var t=new Date,e=t.getFullYear(),a=t.getMonth()+1,i=t.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i),this.currentdate=e+"年"+a+"月"+i+"日"},digitUppercase:function(t){var e=["角","分"],a=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],i=[["元","万","亿"],["","拾","佰","仟"]],n=t<0?"欠":"";t=Math.abs(t);for(var r="",s=0;s<e.length;s++)r+=(a[Math.floor(10*t*Math.pow(10,s))%10]+e[s]).replace(/零./,"");r=r||"整",t=Math.floor(t);for(s=0;s<i[0].length&&t>0;s++){for(var l="",o=0;o<i[1].length&&t>0;o++)l=a[t%10]+i[1][o]+l,t=Math.floor(t/10);r=l.replace(/(零.)*零$/,"").replace(/^$/,"零")+i[0][s]+r}return n+r.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}}},pe=me,he=(a("73e0"),Object(x["a"])(pe,de,ue,!1,null,"e404bdc0",null)),fe=he.exports,_e=a("22ce"),ve={components:{plamp:fe},mixins:[o["b"],o["a"]],data:function(){return{list:null,index:3,flag:!0,listLoading:!0,dialogStatus:"",lamp:null,dataForm:{cid:"",buyname:null,phone:"",real_price:"",buydate:"",card_no:""},dialogFormVisible:!1,rules:{buyname:[{required:!0,message:"购买人不能为空",trigger:"blur"}]}}},watch:{order:function(t){t===this.index&&this.getStatus()},cems:{handler:function(t){this.getList()},immediate:!0}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};re(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1})),Object(_e["h"])().then((function(e){t.lamp=e.data.data[0]}))},handleCreate:function(){var t=this;this.resetForm(),this.flag=!0,this.dataForm.real_price=this.lamp.sellprice,this.dataForm.buydate=this.lamp.vcnote,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},resetForm:function(){this.dataForm={cid:this.cems.id,buyname:"",phone:"",buydate:"",real_price:"",card_no:""}},createData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&se(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"添加成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},handleUpdate:function(t){var e=this;this.dataForm=Object.assign({},t),this.dialogStatus="update",this.flag=!1,this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},updateData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&oe(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"更新信息成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},lampPrint:function(t){var e={list:t,operate:this.user.realname};this.$refs.plamp_.getlist(e)},handlePay:function(t){var e=this;this.$confirm("付款此订单后将无法修改和删除, 是否继续?","付款操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){ce(t).then((function(t){e.$message({type:"success",message:"付款服务成功"}),e.getList()})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},handleDelete:function(t){var e=this;le({id:t.id}).then((function(a){e.$message({type:"success",message:"删除成功"});var i=e.list.indexOf(t);e.list.splice(i,1)})).catch((function(t){e.$message({type:"warning",message:t})}))}}},ge=ve,be=Object(x["a"])(ge,ie,ne,!1,null,null,null),ye=be.exports,Fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加修缮服务")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"sname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发起时间",prop:"sub_time",width:"180"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"修缮状态",prop:"repair_status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("or_status")(e.row.repair_status)}},[t._v("\n          "+t._s(1==e.row.repair_status?"未修缮":"已修缮")+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding fixed-width",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[[1==e.row.repair_status?a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),1==e.row.repair_status?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")]):t._e()]]}}])})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!0,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"描述信息",prop:"desc"}},[a("el-input",{attrs:{type:"textarea",rows:4},model:{value:t.dataForm.desc,callback:function(e){t.$set(t.dataForm,"desc",e)},expression:"dataForm.desc"}})],1),a("br"),t._v(" "),a("el-form-item",{attrs:{label:"上传修缮前的图片"}},[a("el-upload",{staticClass:"upload-demo",attrs:{headers:t.headers,action:t.uploadPath,"on-preview":t.handlePreview,name:t.dataForm.title,"on-remove":t.handleRemove,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"before-remove":t.beforeRemove,multiple:"",limit:10,"on-exceed":t.handleExceed,"file-list":t.fileList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过2M")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("确定")])],1)],1)],1)},xe=[],ke=a("2d63"),we=a("c3be"),$e=a("91b6"),Ce=a("5f87"),Se={mixins:[o["b"],o["a"]],data:function(){return{uploadPath:$e["a"],list:null,id:"",rid:"",index:5,flag:!0,listLoading:!0,dialogStatus:"",fileList:[],dataForm:{cid:"",desc:"",b_img_urls:[]},dialogFormVisible:!1,rules:{buyname:[{required:!0,message:"购买人不能为空",trigger:"blur"}]}}},computed:{headers:function(){return{token:Object(Ce["a"])()}}},watch:{order:function(t){t===this.index&&this.getStatus()},cems:{handler:function(t){this.getList()},immediate:!0}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id};Object(we["i"])(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},handleCreate:function(){var t=this;this.resetForm(),this.flag=!0,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},resetForm:function(){this.dataForm={cid:this.cems.id,desc:"",b_img_urls:[]},this.fileList=[]},createData:function(){var t,e=this,a=Object(ke["a"])(this.fileList);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.type=2,delete i.name,delete i.uid,delete i.status}}catch(n){a.e(n)}finally{a.f()}this.dataForm.b_img_urls=this.fileList,console.log(this.dataForm),this.$refs["dataForm"].validate((function(t){t&&Object(we["g"])(e.dataForm).then((function(t){e.getList(),e.dialogFormVisible=!1,e.$message({type:"success",message:"添加成功"})})).catch((function(t){e.$message({type:"warning",message:t})}))}))},handleUpdate:function(t){var e=this;this.fileList=[],this.dialogStatus="update",this.dataForm.id=t.id;var a={id:t.id};Object(we["h"])(a).then((function(t){t.data.b_urls&&(e.fileList=t.data.b_urls),e.dataForm.desc=t.data.desc})),this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},updateData:function(){var t=this;this.dataForm.cid=this.cems.id;var e,a=Object(ke["a"])(this.fileList);try{for(a.s();!(e=a.n()).done;){var i=e.value;i.type=2,delete i.name,delete i.uid,delete i.status}}catch(n){a.e(n)}finally{a.f()}this.dataForm.b_img_urls=this.fileList,this.$refs["dataForm"].validate((function(e){e&&Object(we["c"])(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"更新成功"})})).catch((function(e){t.$message({type:"warning",message:e})}))}))},handlePay:function(t){var e=this;this.$confirm("付款此订单后将无法修改和删除, 是否继续?","付款操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){lamppay(t).then((function(t){e.$message({type:"success",message:"付款服务成功"}),e.getList()})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},handleDelete:function(t){var e=this,a={id:t.id};Object(we["a"])(a).then((function(a){e.$message({type:"success",message:"删除成功"});var i=e.list.indexOf(t);e.list.splice(i,1)})).catch((function(t){e.$message({type:"warning",message:t})}))},handleRemove:function(t,e){var a,i=Object(ke["a"])(this.fileList);try{for(i.s();!(a=i.n()).done;){var n=a.value;if(n.uid===t.uid){var r=this.fileList.indexOf(n);this.fileList.splice(r,1);break}}}catch(s){i.e(s)}finally{i.f()}},handlePreview:function(t){},handleExceed:function(t,e){this.$message.warning("当前限制选择 1个文件，本次选择了 ".concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))},beforeRemove:function(t,e){var a=this;return this.$confirm("确定移除此图片吗？","移除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var e={id:t.id,rid:a.dataForm.id,flag:"before"};Object(we["b"])(e).then((function(t){console.log(t.data)})).catch((function(t){a.$message({type:"warning",message:t})}))}))},handleAvatarSuccess:function(t,e){var a="http://kykjgm.lxygm.com/"+e.response.data,i={name:e.name,url:a};this.fileList.push(i),this.$notify.success({title:"成功",message:"上传成功"})},beforeAvatarUpload:function(t){console.log(t);var e="image/jpeg"===t.type||"image/png",a=t.size/1024/1024<2;return e||(this.$message.error("上传头像图片只能是 JPG 格式!"),this.handleRemove(t)),a||(this.$message.error("上传头像图片大小不能超过 2MB!"),this.handleRemove(t)),e&&a}}},je=Se,Oe=(a("c9cc"),Object(x["a"])(je,Fe,xe,!1,null,null,null)),Le=Oe.exports,Ve=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加置换服务")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"旧墓名",prop:"old_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"新墓名",prop:"new_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系人",prop:"linkname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"operate_name"}})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!1,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"原墓穴"}},[a("span",{staticStyle:{color:"#1890ff"}},[t._v(t._s(t.cname.classifyname)+t._s(t.cname.cname)+" ")])]),t._v(" "),a("el-form-item",{attrs:{label:"新墓穴"}},[a("span",[t._v(t._s(t.newname))]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",plain:"",size:"mini"},on:{click:function(e){return t.ChangeCmes()}}}),t._v(" "),t.newname?a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"mini"},on:{click:function(e){t.newname=""}}}):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"联系人"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.dataForm.linkman_id,callback:function(e){t.$set(t.dataForm,"linkman_id",e)},expression:"dataForm.linkman_id"}},t._l(t.listlink,(function(t){return a("el-option",{key:t.id,attrs:{label:t.link_name,value:t.id}})})),1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")])],1)],1),t._v(" "),a("Swap-search",{ref:"child",on:{getname:t.getname}})],1)},ze=[],De=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{staticClass:"dialog",attrs:{id:"search","close-on-click-modal":!1,title:t.dialogStatus,visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{size:"mini",clearable:"",placeholder:"请输入墓穴名称"},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",e)},expression:"listQuery.keyword"}}),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{placeholder:"选择墓园",clearable:"",size:"mini"},on:{change:t.handle_area},model:{value:t.listQuery.y_id,callback:function(e){t.$set(t.listQuery,"y_id",e)},expression:"listQuery.y_id"}},t._l(t.garden,(function(t){return a("el-option",{key:t.id,attrs:{label:t.type_name,value:t.id}})})),1),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"选择墓区",clearable:""},model:{value:t.listQuery.q_id,callback:function(e){t.$set(t.listQuery,"q_id",e)},expression:"listQuery.q_id"}},t._l(t.area,(function(t){return a("el-option",{key:t.id,attrs:{label:t.type_name,value:t.id}})})),1),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"选择类型",clearable:""},model:{value:t.listQuery.type_id,callback:function(e){t.$set(t.listQuery,"type_id",e)},expression:"listQuery.type_id"}},t._l(t.type,(function(t){return a("el-option",{key:t.id,attrs:{label:t.type_name,value:t.id}})})),1),t._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"120px"},attrs:{size:"mini",placeholder:"选择墓型",clearable:""},model:{value:t.listQuery.style_id,callback:function(e){t.$set(t.listQuery,"style_id",e)},expression:"listQuery.style_id"}},t._l(t.style,(function(t){return a("el-option",{key:t.id,attrs:{label:t.type_name,value:t.id}})})),1),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{size:"mini",type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查找")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"default-sort":{prop:"sort",order:"ascending"},"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{align:"center",label:"墓区",prop:"classifyname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"墓号",prop:"cname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"墓型",prop:"typename"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"样式",prop:"stylename"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"面积",prop:"area"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"朝向",prop:"orientation"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"价格",prop:"sellprice"}})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}})],1)},Te=[],Ee={components:{Pagination:c["a"]},mixins:[o["a"],o["b"]],data:function(){return{list:null,total:0,garden:null,area:null,style:null,type:null,dialogStatus:"",listLoading:!0,dialogFormVisible:!1,listQuery:{page:1,limit:10,sort:"add_time",order:"desc",keyword:void 0,q_id:"",type_id:"",style_id:"",usestatus:1}}},created:function(){var t=this;Object(r["a"])().then((function(e){t.garden=e.data})),Object(l["i"])().then((function(e){t.style=e.data})),Object(l["j"])().then((function(e){t.type=e.data.data}))},methods:{getList:function(){var t=Object(h["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.listLoading=!0,t.next=3,Object(s["c"])(this.listQuery).then((function(t){e.list=t.data.data,e.total=t.data.total||0,e.listLoading=!1})).catch((function(){e.list=[],e.total=0,e.listLoading=!1}));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleFilter:function(){this.listQuery.page=1,this.getList()},show:function(){this.dialogStatus="墓穴查询",this.dialogFormVisible=!0,this.getList()},handle_area:function(){var t=this;this.area=[],this.listQuery.q_id="",this.dataForm.classify_id="";var e={pid:this.listQuery.y_id||this.dataForm.garden_id,limit:100};Object(r["d"])(e).then((function(e){t.area=e.data.data}))},handleCurrentChange:function(t){null!=t&&(this.dialogFormVisible=!1,this.$emit("getname",t))}}},Me=Ee,Ie=(a("a6c4"),Object(x["a"])(Me,De,Te,!1,null,null,null)),Qe=Ie.exports;function Pe(t){return Object(f["a"])({url:"/historyinfo/get_historyinfo",method:"post",data:t})}function Be(t){return Object(f["a"])({url:"/order/move_cemetery_qian",method:"post",data:t})}function Ne(t){return Object(f["a"])({url:"/order/change_cemetery",method:"post",data:t})}function qe(t){return Object(f["a"])({url:"/order/move_cemetery",method:"post",data:t})}var Re={components:{SwapSearch:Qe},mixins:[o["a"],o["b"]],data:function(){return{list:null,listlink:null,index:4,links:[],newname:"",listLoading:!0,dialogStatus:"",real_price:"",dataForm:{old_cid:"",new_cid:"",new_name:"",old_name:"",linkman_id:""},dialogFormVisible:!1,rules:{}}},watch:{order:function(t){t===this.index&&(this.link(),this.getList())}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id,typeid:1};Pe(e).then((function(e){t.listLoading=!1,t.list=e.data}))},handleCreate:function(){var t=this;this.resetForm(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},resetForm:function(){var t=this;this.newname="",this.dataForm={old_cid:this.cems.id,new_cid:"",new_name:"",old_name:"",linkman_id:""};var e={cid:this.cems.id};Object(rt["f"])(e).then((function(e){t.real_price=e.data[0].real_price}))},createData:function(){var t=this;this.dataForm.old_name=this.cname,this.$refs["dataForm"].validate((function(e){e&&Ne(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"操作成功"}),t.$emit("v")})).catch((function(e){t.$message({type:"warning",message:e})}))}))},ChangeCmes:function(){var t=this;this.$nextTick((function(){t.$refs.child.show()}))},link:function(){var t=this,e={cid:this.cems.id};_(e).then((function(e){t.listlink=e.data}))},getname:function(t){console.log("v",t),this.newname=t.gardenname+t.classifyname+t.cname+t.cname+" / "+t.sellprice+" 元",this.dataForm.new_name=t.gardenname+t.classifyname+t.cname,this.dataForm.new_cid=t.id}}},Ue=Re,Ye=Object(x["a"])(Ue,Ve,ze,!1,null,null,null),Ae=Ye.exports,He=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加迁出服务")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"墓名",prop:"old_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系人",prop:"linkname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系电话",prop:"linkphone"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"operate_name",width:"100"}})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!1,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"墓名"}},[a("span",{staticClass:"tag"},[t._v(t._s(t.cname))])]),t._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"linkname"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.dataForm.linkname,callback:function(e){t.$set(t.dataForm,"linkname",e)},expression:"dataForm.linkname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"linkphone"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.dataForm.linkphone,callback:function(e){t.$set(t.dataForm,"linkphone",e)},expression:"dataForm.linkphone"}})],1),t._v(" "),t.dataForm.photo.length>0?a("el-form-item",{attrs:{label:"照片",prop:"photo"}},t._l(t.dataForm.photo,(function(t,e){return a("img",{key:e,staticStyle:{"margin-left":"10px"},attrs:{src:t,alt:"",width:"80",height:"50"}})})),0):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"vcnote"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:t.dataForm.vcnote,callback:function(e){t.$set(t.dataForm,"vcnote",e)},expression:"dataForm.vcnote"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dataForm.photo=[]}}},[t._v("清空照片")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createmove}},[t._v("上传照片")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")])],1)],1),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}})],1)},Ge=[],Je={components:{card:ut["a"]},mixins:[o["b"],o["a"]],data:function(){return{list:null,index:5,listLoading:!0,dialogStatus:"",dataForm:{cid:"",cem_name:"",price:"",linkname:"",linkphone:"",photo:[],typeid:"3",vcnote:""},dialogFormVisible:!1,rules:{linkname:[{required:!0,message:"联系人不能为空",trigger:"blur"}],linkphone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}]}}},watch:{order:function(t){t===this.index&&this.getList()}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id,typeid:3};Pe(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},handleCreate:function(){var t=this;this.resetForm(),this.dataForm.cem_name=this.cname,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},createmove:function(){this.$refs.cardImg.show()},setImg:function(t){this.dataForm.photo.push(t)},resetForm:function(){this.dataForm={cid:this.cems.id,cem_name:"",linkname:"",price:"",photo:[],linkphone:"",typeid:"3",vcnote:""}},v:function(){this.$emit("v")},createData:function(){var t=this;console.log(this.dataForm),this.$refs["dataForm"].validate((function(e){e&&Be(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"操作成功"}),t.$emit("v")})).catch((function(e){t.$message({type:"warning",message:e})}))}))}}},Xe=Je,Ke=Object(x["a"])(Xe,He,Ge,!1,null,null,null),We=Ke.exports,Ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("退墓操作")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"墓名",prop:"old_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系人",prop:"linkname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系电话",prop:"linkphone"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"备注",prop:"vcnote"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"operate_name",width:"100"}})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!1,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"墓名"}},[a("span",{staticClass:"tag"},[t._v(t._s(t.dataForm.cem_name))])]),t._v(" "),a("el-form-item",{attrs:{label:"联系人",prop:"linkname"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.dataForm.linkname,callback:function(e){t.$set(t.dataForm,"linkname",e)},expression:"dataForm.linkname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"电话",prop:"linkphone"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.dataForm.linkphone,callback:function(e){t.$set(t.dataForm,"linkphone",e)},expression:"dataForm.linkphone"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"vcnote"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.dataForm.vcnote,callback:function(e){t.$set(t.dataForm,"vcnote",e)},expression:"dataForm.vcnote"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")])],1)],1)],1)},ta=[],ea={mixins:[o["b"],o["a"]],data:function(){return{list:null,index:6,listLoading:!0,dialogStatus:"",dataForm:{cid:"",typeid:2,cem_name:"",linkname:"",linkphone:"",vcnote:""},dialogFormVisible:!1,rules:{linkname:[{required:!0,message:"联系人不能为空",trigger:"blur"}],linkphone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}]}}},watch:{order:function(t){t===this.index&&this.getList()}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id,typeid:2};Pe(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},handleCreate:function(){var t=this;this.resetForm(),this.dataForm.cem_name=this.cname,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},resetForm:function(){this.dataForm={cid:this.cems.id,cem_name:"",linkname:"",linkphone:"",vcnote:""}},v:function(){this.$emit("v")},createData:function(){var t=this;this.$refs["dataForm"].validate((function(e){e&&qe(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"操作成功"}),t.$emit("v")})).catch((function(e){t.$message({type:"warning",message:e})}))}))}}},aa=ea,ia=Object(x["a"])(aa,Ze,ta,!1,null,null,null),na=ia.exports,ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticStyle:{margin:"0 0 10px 0"}},[a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:t.handleCreate}},[t._v("添加合墓服务")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"墓名",prop:"old_name"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系人",prop:"linkname"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"联系电话",prop:"linkphone"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作人",prop:"operate_name",width:"100"}})],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,top:"5vh","append-to-body":""},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{inline:!1,rules:t.rules,"status-icon":"","label-position":"left",model:t.dataForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"墓名"}},[a("span",{staticClass:"tag"},[t._v(t._s(t.cname))])]),t._v(" "),a("el-form-item",{attrs:{label:"请选择"}},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.changeRadio},model:{value:t.dataForm.cid,callback:function(e){t.$set(t.dataForm,"cid",e)},expression:"dataForm.cid"}},[a("el-radio",{attrs:{label:1}},[t._v("新立")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("添加")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"备注",prop:"vcnote"}},[a("el-input",{staticStyle:{width:"50%"},attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:t.dataForm.vcnote,callback:function(e){t.$set(t.dataForm,"vcnote",e)},expression:"dataForm.vcnote"}})],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("确定")])],1)],1),t._v(" "),a("card",{ref:"cardImg",on:{setImg:t.setImg}})],1)},sa=[],la={components:{card:ut["a"]},mixins:[o["b"],o["a"]],data:function(){return{list:null,index:6,listLoading:!0,dialogStatus:"",dataForm:{cid:"",cem_name:"",price:"",linkname:"",linkphone:"",photo:[],typeid:"3",vcnote:""},dialogFormVisible:!1,rules:{linkname:[{required:!0,message:"联系人不能为空",trigger:"blur"}],linkphone:[{required:!0,message:"联系电话不能为空",trigger:"blur"}]}}},watch:{order:function(t){t===this.index&&this.getStatus()}},methods:{getList:function(){var t=this;this.listLoading=!0;var e={cid:this.cems.id,typeid:0};Pe(e).then((function(e){t.list=e.data,t.listLoading=!1})).catch((function(){t.list=[],t.listLoading=!1}))},handleCreate:function(){var t=this;this.resetForm(),this.dataForm.cem_name=this.cname,this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick((function(){t.$refs["dataForm"].clearValidate()}))},createmove:function(){this.$refs.cardImg.show()},setImg:function(t){this.dataForm.photo.push(t)},resetForm:function(){this.dataForm={cid:this.cems.id,cem_name:"",linkname:"",price:"",photo:[],linkphone:"",typeid:"3",vcnote:""}},v:function(){this.$emit("v")},changeRadio:function(){},createData:function(){var t=this;console.log(this.dataForm),this.$refs["dataForm"].validate((function(e){e&&Be(t.dataForm).then((function(e){t.getList(),t.dialogFormVisible=!1,t.$message({type:"success",message:"操作成功"}),t.$emit("v")})).catch((function(e){t.$message({type:"warning",message:e})}))}))}}},oa=la,ca=Object(x["a"])(oa,ra,sa,!1,null,null,null),da=ca.exports,ua={name:"VueList",components:{Pagination:c["a"],Service:tt,Sell:Jt,Reserve:ae,lamp:ye,repair:Le,swap:Ae,move:We,returns:na,merge:da},mixins:[o["a"],o["b"]],data:function(){return{isCollapse:!1,tralist:null,list:null,area:null,num:null,total:0,url:"http://kykjgm.lxygm.com/",activeName:"sell",sreach:null,tab:[{label:"预定",name:"reserve"},{label:"购墓",name:"sell"},{label:"服务",name:"service"},{label:"点灯",name:"lamp"},{label:"换墓",name:"swap"},{label:"退墓",name:"returns"},{label:"迁出",name:"move"},{label:"修缮",name:"repair"}],dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},listLoading:!0,gardens:null,flag:!1,listQuery:{page:1,limit:24,q_id:3,keyword:"",sort:"add_time",order:"desc"}}},created:function(){this.getList(),this.gettralist()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(s["c"])(this.listQuery).then((function(e){t.list=e.data.data,t.total=e.data.total||0,t.listLoading=!1})).catch((function(){t.list=[],t.total=0,t.listLoading=!1})),Object(l["h"])(this.listQuery).then((function(e){t.num=e.data})),Object(r["a"])().then((function(e){t.area=e.data}))},handleFilter:function(t){this.listQuery.q_id=t,this.listQuery.page=1,this.getList(),this.gettralist()},handleFilterTag:function(t){this.listQuery.usestatus=t,this.getList()},gettralist:function(){var t=this;Object(r["e"])(this.listQuery).then((function(e){t.tralist=e.data,t.tralist.forEach((function(t){for(var e=0;e<t.cemetery.length;e++){var a=t.cemetery[e];e+1!=a.iy&&t.cemetery.splice(e,0,{id:0})}}))}))},handleFilters:function(){this.listQuery.page=1,this.getList()},createCemetery:function(t){var e=this;this.pay(t.id),this.addCemetery(t);var a={cid:t.id};Object(l["g"])(a).then((function(t){e.dialogStatus=t.data.name,e.addCname(t.data)})),6==t.usestatus||5==t.usestatus?this.dialogFormVisible=!1:this.dialogFormVisible=!0},handleClick:function(t){this.changeOrders(t.index)},v:function(){this.getList(),this.createCemetery(this.cems)}}},ma=ua,pa=(a("078f"),Object(x["a"])(ma,i,n,!1,null,"d8b3c026",null));e["default"]=pa.exports},fe61:function(t,e,a){}}]);