(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-deff9a6e"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return o})),Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function r(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(t,e,a){var o=n(),l=t-o,s=20,c=0;e="undefined"===typeof e?500:e;var d=function t(){c+=s;var n=Math.easeInOutQuad(c,o,l,e);r(n),c<e?i(t):a&&"function"===typeof a&&a()};d()}},"0cd4":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"filter-container"},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入墓号"},model:{value:t.listQuery.keyword,callback:function(e){t.$set(t.listQuery,"keyword",e)},expression:"listQuery.keyword"}}),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /api/v1/service_info/service_infos_by_cemetery"],expression:"['GET /api/v1/service_info/service_infos_by_cemetery']"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.handleFilter}},[t._v("查找")])],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{data:t.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"墓区",prop:"area_name",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"墓号",prop:"cem_name",width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发起人",prop:"sname",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发起时间",prop:"sub_time"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"修缮状态",prop:"repair_status",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("or_status")(e.row.repair_status)}},[t._v("\n          "+t._s(1==e.row.repair_status?"未修缮":"已修缮")+"\n        ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作","class-name":"small-padding",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.repair_status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /api/v1/service_info/get_service_bill_by_cid"],expression:"['GET /api/v1/service_info/get_service_bill_by_cid']"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("编辑")]):t._e(),t._v(" "),1==e.row.repair_status?a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /api/v1/service_info/get_service_bill_by_cid"],expression:"['GET /api/v1/service_info/get_service_bill_by_cid']"}],attrs:{type:"danger",size:"mini"},on:{click:function(a){return t.SendData(e.row)}}},[t._v("归档")]):t._e(),t._v(" "),a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /api/v1/service_info/get_service_bill_by_cid"],expression:"['GET /api/v1/service_info/get_service_bill_by_cid']"}],attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.handlelook(e.row)}}},[t._v("查看")])]}}])})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.page,limit:t.listQuery.limit},on:{"update:page":function(e){return t.$set(t.listQuery,"page",e)},"update:limit":function(e){return t.$set(t.listQuery,"limit",e)},pagination:t.getList}}),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:"编辑",visible:t.dialogFormVisible,top:"5vh"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"dataForm",staticStyle:{"margin-left":"50px"},attrs:{model:t.dataForm,"status-icon":"","label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"开始时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.start_time,callback:function(e){t.$set(t.dataForm,"start_time",e)},expression:"dataForm.start_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"end_time"}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataForm.end_time,callback:function(e){t.$set(t.dataForm,"end_time",e)},expression:"dataForm.end_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"修缮前照片",prop:"b_urls"}},t._l(t.b_urls,(function(t,e){return a("img",{key:e,staticStyle:{"margin-left":"5px"},attrs:{src:t.url,alt:"",width:"100",height:"70"}})})),0),t._v(" "),a("el-form-item",{attrs:{label:"上传修缮后的图片"}},[a("el-upload",{staticClass:"upload-demo",attrs:{headers:t.headers,action:t.uploadPath,"on-preview":t.handlePreview,name:t.dataForm.title,"on-remove":t.handleRemove,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload,"before-remove":t.beforeRemove,multiple:"",limit:10,"on-exceed":t.handleExceed,"file-list":t.fileList,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过2M")])],1)],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.EditData}},[t._v("确定")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{"close-on-click-modal":!1,title:"查看",visible:t.dialogFormVisible_info,top:"5vh"},on:{"update:visible":function(e){t.dialogFormVisible_info=e}}},[a("el-form",{ref:"dataInfo",staticStyle:{"margin-left":"50px"},attrs:{model:t.dataInfo,"status-icon":"","label-position":"left","label-width":"140px"}},[a("el-form-item",{attrs:{label:"发起人"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.dataInfo.sname,callback:function(e){t.$set(t.dataInfo,"sname",e)},expression:"dataInfo.sname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"接收人"}},[a("el-input",{attrs:{disabled:!0},model:{value:t.dataInfo.rname,callback:function(e){t.$set(t.dataInfo,"rname",e)},expression:"dataInfo.rname"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"开始时间",prop:"start_time"}},[a("el-date-picker",{attrs:{type:"date",disabled:"true","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataInfo.start_time,callback:function(e){t.$set(t.dataInfo,"start_time",e)},expression:"dataInfo.start_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"结束时间",prop:"end_time"}},[a("el-date-picker",{attrs:{type:"date",disabled:"true","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.dataInfo.end_time,callback:function(e){t.$set(t.dataInfo,"end_time",e)},expression:"dataInfo.end_time"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"修缮前照片",prop:"b_urls"}},t._l(t.dataInfo.b_urls,(function(t,e){return a("img",{key:e,staticStyle:{"margin-left":"5px"},attrs:{src:t.url,alt:"",width:"100",height:"70"}})})),0),t._v(" "),a("el-form-item",{attrs:{label:"修缮后照片",prop:"a_urls"}},t._l(t.dataInfo.a_urls,(function(t,e){return a("img",{key:e,staticStyle:{"margin-left":"5px"},attrs:{src:t.url,alt:"",width:"100",height:"70"}})})),0)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible_info=!1}}},[t._v("取消")])],1)],1)],1)},r=[],n=(a("7f7f"),a("2d63")),o=a("c3be"),l=a("91b6"),s=a("5f87"),c=a("333d"),d={name:"VueSaveList",components:{Pagination:c["a"]},data:function(){return{uploadPath:l["a"],list:null,fileList:[],list_service:null,operater_name:"",total:0,b_urls:[],image_url:"",flag:!1,info:null,listLoading:!0,listLoading_:!0,dialogStatus:"",dialogStatus2:"",textMap:{update:"查看服务",create:"修缮执行"},listQuery:{page:1,limit:20,keyword:void 0,save_status:"",sort:"add_time",order:"desc"},dataInfo:{sname:"",rname:"",start_time:null,end_time:null,b_urls:[],a_urls:[],task_hour:"",pre_price:"",total_price:""},dialogFormVisible:!1,dialogFormVisible_:!1,dialogFormVisible_info:!1,dataForm:{id:"",start_time:null,end_time:null,task_hour:"",pre_price:"",total_price:"",a_img_urls:[]},rules:{execdate:[{required:!0,message:"服务时间不能为空",trigger:"change"}]}}},computed:{headers:function(){return{token:Object(s["a"])()}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0,Object(o["f"])(this.listQuery).then((function(e){t.list=e.data.repairlist.data,t.total=e.data.repairlist.total||0,t.listLoading=!1})).catch((function(){t.list=[],t.total=0,t.listLoading=!1}))},handleFilter:function(){this.listQuery.page=1,this.getList()},handleUpdate:function(t){var e=this;this.dataForm=Object.assign({},t);var a={id:t.id};Object(o["h"])(a).then((function(t){e.b_urls=t.data.b_urls,t.data.a_urls&&(e.fileList=t.data.a_urls)})),this.dialogFormVisible=!0},handleCreate:function(t){var e=this;this.flag=!1,this.dataForm.id=t.id,this.dialogFormVisible_=!0,this.fileList=[],this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handleRemove:function(t,e){var a,i=Object(n["a"])(this.fileList);try{for(i.s();!(a=i.n()).done;){var r=a.value;if(r.uid===t.uid){var o=this.fileList.indexOf(r);this.fileList.splice(o,1);break}}}catch(l){i.e(l)}finally{i.f()}},handlePreview:function(t){},handleExceed:function(t,e){this.$message.warning("当前限制选择 1个文件，本次选择了 ".concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"))},beforeRemove:function(t,e){var a=this;return this.$confirm("确定移除此图片吗？","移除操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var e={id:t.id,rid:a.dataForm.id,flag:"after"};Object(o["b"])(e).then((function(t){console.log(t.data)})).catch((function(t){a.$message({type:"warning",message:t})}))}))},handlelook:function(t){var e=this;this.rest();var a={id:t.id};Object(o["h"])(a).then((function(t){e.dataInfo=t.data,e.dialogFormVisible_info=!0}))},rest:function(){this.dataInfo={sname:"",rname:"",start_time:null,end_time:null,b_urls:[],a_urls:[],task_hour:"",pre_price:"",total_price:""}},handleAvatarSuccess:function(t,e){var a="http://kykjgm.lxygm.com/"+e.response.data,i={name:e.name,url:a};this.fileList.push(i),this.$notify.success({title:"成功",message:"上传成功"})},beforeAvatarUpload:function(t){console.log(t);var e="image/jpeg"===t.type||"image/png",a=t.size/1024/1024<2;return e||(this.$message.error("上传头像图片只能是 JPG 格式!"),this.handleRemove(t)),a||(this.$message.error("上传头像图片大小不能超过 2MB!"),this.handleRemove(t)),e&&a},EditData:function(){var t,e=this,a=Object(n["a"])(this.fileList);try{for(a.s();!(t=a.n()).done;){var i=t.value;i.type=1,delete i.name,delete i.uid,delete i.status}}catch(r){a.e(r)}finally{a.f()}this.dataForm.a_img_urls=this.fileList,Object(o["d"])(this.dataForm).then((function(t){e.dialogFormVisible=!1,e.getList(),e.$message({type:"success",message:"编辑成功"})})).catch((function(t){e.$message({type:"warning",message:t})}))},SendData:function(t){var e=this;this.$confirm("确定已经修缮完毕吗？","完结操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"confirmTop"}).then((function(){var a={id:t.id};Object(o["e"])(a).then((function(t){e.getList(),e.$message({type:"success",message:"修缮完毕"})})).catch((function(t){e.$message({type:"warning",message:t})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))}}},u=d,m=(a("4f1e"),a("2877")),f=Object(m["a"])(u,i,r,!1,null,null,null);e["default"]=f.exports},"4f1e":function(t,e,a){"use strict";var i=a("95a9"),r=a.n(i);r.a},"91b6":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var i="http://kykjgm.lxygm.com/api/v1/upload/upload"},"95a9":function(t,e,a){},c3be:function(t,e,a){"use strict";a.d(e,"i",(function(){return r})),a.d(e,"g",(function(){return n})),a.d(e,"h",(function(){return o})),a.d(e,"c",(function(){return l})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"f",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"e",(function(){return m}));var i=a("b775");function r(t){return Object(i["a"])({url:"/repair/get_repair_info_by_cid",method:"get",params:t})}function n(t){return Object(i["a"])({url:"/repair/repair_add",method:"post",data:t})}function o(t){return Object(i["a"])({url:"/repair/get_repair_info_by_id",method:"get",params:t})}function l(t){return Object(i["a"])({url:"/repair/repair_edit",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/repair/repair_del_pic",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/repair/repair_del",method:"get",params:t})}function d(t){return Object(i["a"])({url:"/repair/repair_order_list",method:"get",params:t})}function u(t){return Object(i["a"])({url:"/repair/repair_edit_after",method:"post",data:t})}function m(t){return Object(i["a"])({url:"/repair/repair_edit_pic",method:"post",data:t})}}}]);